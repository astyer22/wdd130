"undefined"!=typeof MerchandisingAssociationJS&&null!=MerchandisingAssociationJS&&MerchandisingAssociationJS||(MerchandisingAssociationJS={storeParams:{},baseItemParams:{},merchandisingAssociations:[],associationIndex:0,setValues:function(s,t,i){this.storeParams=s,this.baseItemParams=t,this.baseItemParams.quantity=1,this.merchandisingAssociations=i},setBaseItemQuantity:function(s){if((s=dojo.fromJson(s)).length)for(idx=0;idx<s.length;idx++)for(idx2=0;idx2<MerchandisingAssociationJS.baseItemParams.components.length;idx2++){if(MerchandisingAssociationJS.baseItemParams.components[idx2].skus)for(idx3=0;idx3<MerchandisingAssociationJS.baseItemParams.components[idx2].skus.length;idx3++)if(MerchandisingAssociationJS.baseItemParams.components[idx2].skus[idx3].id==s[idx].id){MerchandisingAssociationJS.baseItemParams.components[idx2].id=s[idx].id;break}if(MerchandisingAssociationJS.baseItemParams.components[idx2].id==s[idx].id){MerchandisingAssociationJS.baseItemParams.components[idx2].quantity=s[idx].quantity;break}}else MerchandisingAssociationJS.baseItemParams.quantity=s},setBaseItemAttributes:function(s){this.baseItemParams.attributes=dojo.fromJson(s)},setBaseItemAttributesFromProduct:function(s,t){var i=productDisplayJS.selectedAttributesList["entitledItem_"+t];MerchandisingAssociationJS.setBaseItemAttributes(dojo.toJson(i))},changeItem:function(s){this.associationIndex+s>=0&&this.associationIndex+s<this.merchandisingAssociations.length&&(this.associationIndex=this.associationIndex+s,dojo.byId("association_item_name").innerHTML=this.merchandisingAssociations[this.associationIndex].name,null!=document.getElementById("ProductInfoName_"+this.merchandisingAssociations[this.associationIndex-s].productId)&&(document.getElementById("ProductInfoName_"+this.merchandisingAssociations[this.associationIndex-s].productId).value=this.merchandisingAssociations[this.associationIndex].name,document.getElementById("ProductInfoName_"+this.merchandisingAssociations[this.associationIndex-s].productId).id="ProductInfoName_"+this.merchandisingAssociations[this.associationIndex].productId),dojo.byId("association_thumbnail").src=this.merchandisingAssociations[this.associationIndex].thumbnail,null!=document.getElementById("ProductInfoImage_"+this.merchandisingAssociations[this.associationIndex-s].productId)&&(document.getElementById("ProductInfoImage_"+this.merchandisingAssociations[this.associationIndex-s].productId).value=this.merchandisingAssociations[this.associationIndex].thumbnail,document.getElementById("ProductInfoImage_"+this.merchandisingAssociations[this.associationIndex-s].productId).id="ProductInfoImage_"+this.merchandisingAssociations[this.associationIndex].productId),dojo.byId("association_thumbnail").alt=this.merchandisingAssociations[this.associationIndex].name,dojo.byId("combined_total").innerHTML=this.merchandisingAssociations[this.associationIndex].offeredCombinedPrice,null!=document.getElementById("ProductInfoPrice_"+this.merchandisingAssociations[this.associationIndex-s].productId)&&(document.getElementById("ProductInfoPrice_"+this.merchandisingAssociations[this.associationIndex-s].productId).value=this.merchandisingAssociations[this.associationIndex].skuOfferPrice,document.getElementById("ProductInfoPrice_"+this.merchandisingAssociations[this.associationIndex-s].productId).id="ProductInfoPrice_"+this.merchandisingAssociations[this.associationIndex].productId),dojo.byId("list_total").innerHTML=this.merchandisingAssociations[this.associationIndex].listedCombinedPrice,void 0==dojo.byId("association_url").ontouchend&&(dojo.byId("association_url").href=this.merchandisingAssociations[this.associationIndex].url),dojo.byId("association_url").title=this.merchandisingAssociations[this.associationIndex].shortDesc,void 0!=dojo.byId("association_url").ontouchend&&(currentPopup="",dojo.byId("association_url").setAttribute("ontouchend","handlePopup('"+this.merchandisingAssociations[this.associationIndex].url+"','merchandisingAssociation_QuickInfoDiv"+this.merchandisingAssociations[this.associationIndex].id+"')")),dojo.byId("merchandisingAssociation_QuickInfo").href="javascript:QuickInfoJS.showDetails("+this.merchandisingAssociations[this.associationIndex].id+");",0==this.associationIndex?(dojo.query("#up_arrow").removeClass("up_active"),dojo.query("#down_arrow").addClass("down_active"),dojo.byId("down_arrow").focus()):this.merchandisingAssociations.length-1==this.associationIndex?(dojo.query("#down_arrow").removeClass("down_active"),dojo.query("#up_arrow").addClass("up_active"),dojo.byId("up_arrow").focus()):(dojo.query("#up_arrow").addClass("up_active"),dojo.query("#down_arrow").addClass("down_active")))},setCommonParams:function(){var s=new Object;return s.storeId=this.storeParams.storeId,s.catalogId=this.storeParams.catalogId,s.langId=this.storeParams.langId,s.orderId=".",s.calculateOrder="0",s.inventoryValidation="true",s},validate:function(){if("BundleBean"==this.baseItemParams.type){for(idx=0;idx<this.baseItemParams.components.length;idx++)if(!isPositiveInteger(this.baseItemParams.components[idx].quantity))return void MessageHelper.displayErrorMessage(storeNLS.QUANTITY_INPUT_ERROR)}else{if("ProductBean"==this.baseItemParams.type&&(null==this.baseItemParams.attributes||"undefined"==this.baseItemParams.attributes))return void MessageHelper.displayErrorMessage(storeNLS.ERR_RESOLVING_SKU);if(!isPositiveInteger(this.baseItemParams.quantity))return void MessageHelper.displayErrorMessage(storeNLS.QUANTITY_INPUT_ERROR)}},addBoth2ShopCart:function(catEntryID_baseItem,catEntryID_MA,catEntryID_MA_quantity,associationIndex){if(this.associationIndex=associationIndex,this.validate(),isPositiveInteger(catEntryID_MA_quantity)){var params=this.setCommonParams();if(shoppingActionsJS.productAddedList=new Object,"ItemBean"==this.baseItemParams.type||"PackageBean"==this.baseItemParams.type||"DynamicKitBean"==this.baseItemParams.type)updateParamObject(params,"catEntryId",this.baseItemParams.id,!1,-1),updateParamObject(params,"quantity",this.baseItemParams.quantity,!1,-1),"DynamicKitBean"==this.baseItemParams.type&&updateParamObject(params,"catalogEntryType","dynamicKit",-1),"ItemBean"==this.baseItemParams.type?shoppingActionsJS.saveAddedProductInfo(Math.abs(this.baseItemParams.quantity),this.baseItemParams.productId,this.baseItemParams.id,this.baseItemParams.attributes):shoppingActionsJS.saveAddedProductInfo(Math.abs(this.baseItemParams.quantity),this.baseItemParams.productId,this.baseItemParams.id,shoppingActionsJS.selectedAttributesList["entitledItem_"+this.baseItemParams.id]);else if("BundleBean"==this.baseItemParams.type)for(idx=0;idx<this.baseItemParams.components.length;idx++)if(updateParamObject(params,"catEntryId",this.baseItemParams.components[idx].id,!1,-1),updateParamObject(params,"quantity",this.baseItemParams.components[idx].quantity,!1,-1),void 0!=this.baseItemParams.components[idx].productId){var selectedAttrList=new Object;for(attr in shoppingActionsJS.selectedProducts[this.baseItemParams.components[idx].productId])selectedAttrList[attr]=shoppingActionsJS.selectedProducts[this.baseItemParams.components[idx].productId][attr];shoppingActionsJS.saveAddedProductInfo(Math.abs(this.baseItemParams.components[idx].quantity),this.baseItemParams.components[idx].productId,this.baseItemParams.components[idx].id,selectedAttrList)}else shoppingActionsJS.saveAddedProductInfo(Math.abs(this.baseItemParams.components[idx].quantity),this.baseItemParams.components[idx].id,this.baseItemParams.components[idx].id,shoppingActionsJS.selectedProducts[this.baseItemParams.components[idx].id]);else{var sku=this.resolveSKU();if(-1==sku)return void MessageHelper.displayErrorMessage(storeNLS.ERR_RESOLVING_SKU);updateParamObject(params,"catEntryId",sku,!1,-1),updateParamObject(params,"quantity",this.baseItemParams.quantity,!1,-1),shoppingActionsJS.saveAddedProductInfo(Math.abs(this.baseItemParams.quantity),this.baseItemParams.id,sku,this.baseItemParams.attributes)}if("ItemBean"==this.merchandisingAssociations[this.associationIndex].type||"PackageBean"==this.merchandisingAssociations[this.associationIndex].type||"DynamicKitBean"==this.merchandisingAssociations[this.associationIndex].type)updateParamObject(params,"catEntryId",this.merchandisingAssociations[this.associationIndex].id,!1,-1),updateParamObject(params,"quantity",catEntryID_MA_quantity,!1,-1),void 0!=this.merchandisingAssociations[this.associationIndex].productId?shoppingActionsJS.saveAddedProductInfo(Math.abs(catEntryID_MA_quantity),this.merchandisingAssociations[this.associationIndex].productId,this.merchandisingAssociations[this.associationIndex].id,shoppingActionsJS.selectedAttributesList["entitledItem_"+this.merchandisingAssociations[this.associationIndex].id]):shoppingActionsJS.saveAddedProductInfo(Math.abs(catEntryID_MA_quantity),this.merchandisingAssociations[this.associationIndex].id,this.merchandisingAssociations[this.associationIndex].id,shoppingActionsJS.selectedAttributesList["entitledItem_"+this.merchandisingAssociations[this.associationIndex].id]),this.addItems2ShopCart(params);else if("BundleBean"==this.merchandisingAssociations[this.associationIndex].type){for(idx=0;idx<this.merchandisingAssociations[this.associationIndex].components.length;idx++)updateParamObject(params,"catEntryId",this.merchandisingAssociations[this.associationIndex].components[idx].id,!1,-1),updateParamObject(params,"quantity",catEntryID_MA_quantity,!1,-1),shoppingActionsJS.saveAddedProductInfo(Math.abs(catEntryID_MA_quantity),this.merchandisingAssociations[this.associationIndex].components[idx].id,this.merchandisingAssociations[this.associationIndex].components[idx].id,shoppingActionsJS.selectedProducts[this.merchandisingAssociations[this.associationIndex].components[idx].id]);this.addItems2ShopCart(params)}else{var entitledItemJSON=null;entitledItemJSON=null!=dojo.byId(catEntryID_MA)?eval("("+dojo.byId(catEntryID_MA).innerHTML+")"):shoppingActionsJS.getEntitledItemJsonObject(),shoppingActionsJS.setEntitledItems(entitledItemJSON);var catEntryID_MA_SKU=shoppingActionsJS.getCatalogEntryId(catEntryID_MA);if(null==catEntryID_MA_SKU)return void MessageHelper.displayErrorMessage(storeNLS.ERR_RESOLVING_SKU);updateParamObject(params,"catEntryId",catEntryID_MA_SKU,!1,-1),updateParamObject(params,"quantity",catEntryID_MA_quantity,!1,-1),shoppingActionsJS.saveAddedProductInfo(catEntryID_MA_quantity,catEntryID_MA.split("_")[1],catEntryID_MA_SKU,shoppingActionsJS.selectedAttributesList["entitledItem_"+this.merchandisingAssociations[this.associationIndex].id]),this.addItems2ShopCart(params)}}else MessageHelper.displayErrorMessage(storeNLS.QUANTITY_INPUT_ERROR)},resolveSKU:function(){for(idx=0;idx<this.baseItemParams.skus.length;idx++){var s=0,t=0;for(attribute in this.baseItemParams.skus[idx].attributes){if(t++,!this.baseItemParams.attributes||this.baseItemParams.skus[idx].attributes[attribute]!=this.baseItemParams.attributes[attribute])break;s++}if(s==t)return this.baseItemParams.skus[idx].id}return-1},addItems2ShopCart:function(s){var t="AddOrderItem";"dynamicKit"==s.catalogEntryType&&(t="AddPreConfigurationToCart"),submitRequest()&&(cursor_wait(),wc.service.invoke(t,s))},subscribeToEvents:function(s){dojo.topic.subscribe("Quantity_Changed",MerchandisingAssociationJS,MerchandisingAssociationJS.setBaseItemQuantity),dojo.topic.subscribe("DefiningAttributes_Resolved_"+s,MerchandisingAssociationJS.setBaseItemAttributesFromProduct)}});