dojo.require("wc.service.common"),dojo.require("wc.render.common"),GlobalLoginJS={langId:"-1",storeId:"",catalogId:"",activePanel:{},widgetsLoadedOnPage:[],isPanelVisible:!0,globalLogInWidgetID:"Header_GlobalLogin",mouseDownConnectHandle:null,setCommonParameters:function(e,o,t){this.langId=e,this.storeId=o,this.catalogId=t,cursor_clear()},hideGLPanel:function(e){this.isPanelVisible=e},registerWidget:function(e){this.widgetsLoadedOnPage.push(e)},InitHTTPSecure:function(e){if(document.body.clientWidth<=1024)return event&&event.stopPropagation(),event&&event.preventDefault(),void $("#myAccountBtn-mobile_wrap").click();if(document.getElementById("global_signIn_Confirmarion_PageName")){var o="";return document.getElementById("global_signIn_Confirmarion_orderId")&&(o="&orderId="+document.getElementById("global_signIn_Confirmarion_orderId").value),void(window.location=getAbsoluteURL()+"AjaxLogonForm?myAcctMain=1&storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&pageFrom=orderConfirmation"+o)}var t=document.location.href,n=t.lastIndexOf("s",4);if(-1==n){if(WCParamJS.urlPrefixForHTTP)n=(a=t.substring(WCParamJS.urlPrefixForHTTP.length)).indexOf("/"),a=WCParamJS.urlPrefixForHTTPS+a.substring(n);else var a=t.substring(0,4)+"s"+t.substring(4);return setCookie("WC_DisplaySignInPanel_"+WCParamJS.storeId,"true",{path:"/",domain:cookieDomain}),void(window.location=a)}this.displayPanel(e)},displayPanel:function(e){var o=getCookie("WC_RedirectToPage_"+WCParamJS.storeId);void 0!=o&&null!=o&&setCookie("WC_RedirectToPage_"+WCParamJS.storeId,null,{expires:-1,path:"/",domain:cookieDomain}),void 0==o&&window.location.pathname.indexOf("AjaxOrderItemDisplayView")>0?o=WCParamJS.homePageURL+"/AjaxOrderItemDisplayView?catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&storeId="+WCParamJS.storeId:void 0==o&&(o=getAbsoluteURL()+"AjaxLogonForm?myAcctMain=1&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&storeId="+WCParamJS.storeId);var t=require("dojo/dom-attr"),n=dojo.byId(e);if(null!=n){var a=t.get(e,"panel-loaded");if(null!=a&&a){if(this.togglePanel(n),this.toggleSignInButton("Header_GlobalLogin_GlobalLogon"),null!=o&&void 0!==o){var i=document.getElementById(this.globalLogInWidgetID+"_GlobalLogon"),r=document.getElementById("GlobalLoginSwitch"),l=document.getElementById("orderMove");null!=i&&void 0!==i&&(null!=r&&void 0!==r&&"true"==r.value?(console.debug("global login return swich enabled and shopping cart page"),window.location.pathname.indexOf("/AjaxOrderItemDisplayView")>0&&null!=l&&void 0!==l?i.URL.value=l.value+"&displayMergeCartMessage=true":i.URL.value=document.location.href):i.URL.value=o)}}else if("undefined"==typeof isOnPasswordUpdateForm||0==isOnPasswordUpdateForm){if(!submitRequest())return;document.getElementById("grayOut").style.display="block",wc.render.updateContext("GlobalLogin_context",{displayContract:"false",widgetId:e,redirectToPageName:o})}updateQuickLinksBar()}},togglePanel:function(e){require("dojo/dom-style");var o=require("dojo/dom-class"),t=require("dojo/dom-attr"),n=t.get(e,"data-toggle-control");null!=this.activePanel.active&&null!=this.activePanel.selected?(o.toggle(this.activePanel.active,"active"),o.toggle(this.activePanel.selected,"selected"),this.activePanel.active!=e.id?(o.toggle(e,"active"),o.toggle(n,"selected"),this.activePanel.active=e.id,this.activePanel.selected=n):(delete this.activePanel.active,delete this.activePanel.selected,t.set(e.id,"panel-loaded",!1),this.unregisterMouseDown())):(o.toggle(e,"active"),o.toggle(n,"selected"),this.activePanel.active=e.id,this.activePanel.selected=n,this.registerMouseDown())},setFocus:function(){dojo.byId(this.globalLogInWidgetID+"_WC_AccountDisplay_FormInput_logonId_In_Logon_1").focus()},updateGlobalLoginSignInContent:function(e){if(submitRequest()){cursor_wait();var o=getCookie("WC_RedirectToPage_"+WCParamJS.storeId);void 0!=o&&null!=o&&setCookie("WC_RedirectToPage_"+WCParamJS.storeId,null,{expires:-1,path:"/",domain:cookieDomain}),wc.render.updateContext("GlobalLogin_context",{displayContract:"false",widgetId:e,redirectToPageName:o})}},updateGlobalLoginUserDisplay:function(e){require("dojo/dom").byId("Header_GlobalLogin_signOutQuickLinkUser").innerHTML=e},initGlobalLoginUrl:function(e,o){wc.render.getRefreshControllerById(e).url=o},updateGlobalLoginContent:function(e){submitRequest()&&(cursor_wait(),wc.render.updateContext("GlobalLogin_context",{displayContract:"true",widgetId:e}))},updateOrganization:function(e,o){var t=o+"_orgSetInSessionURL",n=document.getElementById(t);if(null!=n){var a=document.location.href;n.value=a}var i=document.forms[o+"_"+e];submitRequest()&&processAndSubmitForm(i)},prepareSubmit:function(e){var o=e+"_";if(MessageHelper.removeBPSAlertErrorId(),null!=document.getElementById(o+"signInDropdown")&&document.getElementById(o+"signInDropdown").className.indexOf("active")>-1){var t;if(document.getElementById(o+"inlinelogonErrorMessage_GL_logonPassword").setAttribute("class","errorLabel"),document.getElementById(o+"inlineLogonErrorMessage_GL_logonId").setAttribute("class","errorLabel"),null!=(t=document.getElementById(o+"WC_AccountDisplay_FormInput_logonId_In_Logon_1"))&&this.isEmpty(t.value))return cursor_wait(),bpAlerts.createAlert("","Header_GlobalLogin_logonErrorMessage_GL","after","error","",storeNLS.ERROR_LOGIN_IN_ERROR_EMPTY_LOGONID),!1;if(null!=(t=document.getElementById(o+"WC_AccountDisplay_FormInput_logonPassword_In_Logon_1"))&&this.isEmpty(t.value))return cursor_wait(),bpAlerts.createAlert("","Header_GlobalLogin_logonErrorMessage_GL","after","error","",storeNLS.ERROR_LOGIN_IN_ERROR_EMPTY_PASSWORD),!1}return!0},isEmpty:function(e){var o=new RegExp(/^\s+$/);return!(null!=e&&""!=e&&!o.test(e))},updateContract:function(e){var o=document.forms[e];submitRequest()&&o.submit()},deleteUserLogonIdCookie:function(e){null!=getCookie("WC_LogonUserId_"+WCParamJS.storeId)&&setCookie("WC_LogonUserId_"+WCParamJS.storeId,null,{expires:-1,path:"/",domain:cookieDomain})},changeRememberMeState:function(e,o){var t=document.getElementById(o);t.className.indexOf("active")>-1?(t.className=t.className.replace("active",""),t.setAttribute("aria-checked","false"),t.setAttribute("src",e+"images/checkbox.png"),document.getElementById(o.replace("_img","")).setAttribute("value","false")):(t.className=t.className+" active",t.setAttribute("src",e+"images/checkbox_checked.png"),t.setAttribute("aria-checked","true"),document.getElementById(o.replace("_img","")).setAttribute("value","true"))},deleteLoginCookies:function(){this.deleteUserLogonIdCookie(),setCookie("WC_BuyOnBehalf_"+WCParamJS.storeId,null,{path:"/",expires:-1,domain:cookieDomain})},submitGLSignInForm:function(e,o){service=wc.service.getServiceById("globalLoginAjaxLogon"),service.formId=e;var t={};t.widgetId=o,document.getElementById(o+"_WC_AccountDisplay_FormInput_errorViewName_In_Logon_1")&&(document.getElementById(o+"_WC_AccountDisplay_FormInput_errorViewName_In_Logon_1").value="AjaxActionErrorResponse"),submitRequest()&&(cursor_wait(),wc.service.invoke("globalLoginAjaxLogon",t))},processNextURL:function(){var e=getCookie("WC_nextURL_"+WCParamJS.storeId);void 0!=e&&e.length>0&&(-1!=(e=e.replace(/&amp;/g,"&")).indexOf("AjaxRESTOrderItemAdd")?invokeItemAdd(e):invokeOtherService(e))},registerMouseDown:function(){null==this.mouseDownConnectHandle&&(this.mouseDownConnectHandle=dojo.connect(document.documentElement,"onmousedown",this,"handleMouseDown"))},unregisterMouseDown:function(){null!=this.mouseDownConnectHandle&&(dojo.disconnect(this.mouseDownConnectHandle),this.mouseDownConnectHandle=null)},handleRememberMe:function(e){var o=dojo.byId(e);o.value=o.checked},handleMouseDown:function(e){var o=require("dojo/dom-class"),t=require("dojo/dom-geometry"),n=require("dojo/query");if(null!=this.activePanel.active&&null!=this.activePanel.selected){var a=dojo.byId(this.activePanel.active),i=dojo.byId(this.activePanel.selected);if(a){var r=e.target;if(r!=document.documentElement){for(var l=!0;r&&r!=document.documentElement;){if(null!=dojo.byId(r.id+"_dropdown")&&null!=dojo.byId(a.id+"_numEntitledContracts")&&dojo.byId(a.id+"_numEntitledContracts").value>0){var d=t.position(r);if((m=window.innerHeight)-d.y>d.y)var s=m-d.y;else s=d.y;dojo.byId(r.id+"_dropdown").clientHeight>s&&(dojo.byId(r.id+"_dropdown").style.height=s+"px")}if(r==a||r==i||o.contains(r,"dijitPopup")){l=!1;break}r=r.parentNode}if(null==r){for(var c=n("div",a),u=0;u<c.length;u++){var g=t.position(c[u]);if(e.clientX>=g.x&&e.clientX<g.x+g.w&&e.clientY>=g.y&&e.clientY<g.y+g.h){l=!1;break}}if(null!=dojo.byId(a.id+"_WC_B2BMyAccountParticipantRole_select_2_dropdown")&&"none"!=dojo.byId(a.id+"_WC_B2BMyAccountParticipantRole_select_2_dropdown").style.display&&null!=dojo.byId(a.id+"_numEntitledContracts")&&dojo.byId(a.id+"_numEntitledContracts").value>0){var m;d=t.position(dojo.byId(a.id+"_WC_B2BMyAccountParticipantRole_select_2"));if((m=window.innerHeight)-d.y>d.y)s=m-d.y;else s=d.y;dojo.byId(a.id+"_WC_B2BMyAccountParticipantRole_select_2_dropdown").clientHeight>s&&(dojo.byId(a.id+"_WC_B2BMyAccountParticipantRole_select_2_dropdown").style.height=s+"px")}}l&&this.togglePanel(a)}}}},closeICSignInDialog:function(){cursor_clear(),dojo.removeClass("Header_GlobalLogin","ic"),this.togglePanel(dojo.byId("Header_GlobalLogin"))},instantCreditDialogBackButton:function(){this.closeICSignInDialog(),cursor_wait(),dijit.byId("BPSInstantCreditFetchDialog").show()},cancelButtonOnLogin:function(){if(void 0!==analyticsDataLayer.common){var e=analyticsDataLayer.common.tm_Rfrl_Url,o=analyticsDataLayer.common.tm_Pg_ID,t=document.URL;null!=e&&""!=e?-1!==e.indexOf("PersonChangeServicePasswordReset")||-1!==e.indexOf("UserRegistrationForm")||-1!==e.indexOf("UserPasswordUpdate")||-1!==e.indexOf("AddressBookForm")||-1!==e.indexOf("ShowWallet")||-1!==e.indexOf("TrackOrderStatus")||-1!==e.indexOf("WishListDisplayView")||-1!==e.indexOf("OutdoorRewards")||-1!==e.indexOf("AjaxLogonForm")||-1!==t.indexOf("Basspro.com")||-1!==t.indexOf("basspro.com")?window.location.href=WCParamJS.homePageURL:-1!==e.indexOf("OrderShippingBillingView")?window.location.href=WCParamJS.homePageURL+"/AjaxOrderItemDisplayView?catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&storeId="+WCParamJS.storeId:window.location.href=e:window.location.href="Checkout_OnePageCheckout"==o?WCParamJS.homePageURL+"/AjaxOrderItemDisplayView?catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&storeId="+WCParamJS.storeId:WCParamJS.homePageURL}},toggleSignInButton:function(e){"Header_GlobalLogin_GlobalLogon"==e&&void 0!=document.getElementById("Header_GlobalLogin_WC_AccountDisplay_FormInput_logonId_In_Logon_1")&&null!=document.getElementById("Header_GlobalLogin_WC_AccountDisplay_FormInput_logonId_In_Logon_1")&&(""!=document.getElementById("Header_GlobalLogin_WC_AccountDisplay_FormInput_logonId_In_Logon_1").value&&""!=document.getElementById("Header_GlobalLogin_WC_AccountDisplay_FormInput_logonPassword_In_Logon_1").value?document.getElementById("Header_GlobalLogin_WC_AccountDisplay_links_2").classList.remove("not-active"):document.getElementById("Header_GlobalLogin_WC_AccountDisplay_links_2").classList.add("not-active"))},updateCQEventAnalytics:function(e,o,t){var n={eventName:"cqEvent"};n.timeStamp=new Date,n.type="account",n.cv=e,n.action=o,n.cs=t,"undefined"!=typeof analyticsLayersJS&&analyticsLayersJS.addAnalyticsEvent(n)}};