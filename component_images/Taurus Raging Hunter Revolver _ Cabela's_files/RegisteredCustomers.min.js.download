require(["dojo/html","dojo/on","dojo/query","dojo/topic","dojo/dom","dojo/dom-style","dojo/dom-class","dojo/_base/event","dojo/_base/array","dojo/domReady!"],function(e,s,r,t,o,a,n,d,i){RegisteredCustomers=function(){this.searchListData={progressBarId:"RegisteredCustomersList_form_botton_1",formId:"RegisteredCustomersSearch_searchForm",searchButtonId:"RegisteredCustomersList_form_botton_1",clearButtonId:"RegisteredCustomersList_form_botton_2"},this.csrResetPasswordIds={administratorPasswordId:"administratorPassword",errorDivId:"csr_resetPassword_error",errorMessageId:"csr_resetPassword_error_msg",parentNodeId:"csr_reset_password",resetPasswordButtonId:"csr_resetPassword_button",resetPasswordDropDownPanelId:"csr_resetPassword_dropdown_panel"},this.csrPasswordEnabled=!1,this.setUpEvents=function(){var e=this,r=dojo.byId(this.searchListData.searchButtonId);null!=r&&s(r,"click",function(s){e.doSearch()}),null!=(r=dojo.byId(this.searchListData.clearButtonId))&&s(r,"click",function(s){e.clearFilter()})},this.clearFilter=function(){this.clearSearchResults(),dojo.query('#RegisteredCustomersSearch_searchForm input[id ^= "RegisteredCustomersSearch_"]').forEach(function(e){e.value=null}),dojo.query('#RegisteredCustomersSearch_searchForm table[id ^= "RegisteredCustomersSearch_"]').forEach(function(e){var s=dijit.byId(e.id);null!=s&&s.setValue("-1")})},this.doSearch=function(){this.clearSearchResults();var e=!1;if(dojo.query("#"+this.searchListData.formId+' input[id ^= "RegisteredCustomersSearch_"]').forEach(function(s){var r=s.value;null!=r&&""!=r&&(e=!0)}),e||dojo.query("#"+this.searchListData.formId+' table[id ^= "RegisteredCustomersSearch_"]').forEach(function(s){""!=dijit.byId(s.id).value&&(e=!0)}),!e)return MessageHelper.formErrorHandleClient(this.searchListData.searchButtonId,storeNLS.CSR_NO_SEARCH_CRITERIA),!1;if(wc.render.getContextById("registeredCustomersSearchResultsContext").properties.searchInitializedForCustomers="true",setCurrentId(this.searchListData.progressBarId),submitRequest()){cursor_wait();wc.render.getRefreshControllerById("registeredCustomersController").formId=this.searchListData.formId,wc.render.updateContext("registeredCustomersSearchResultsContext",{})}},this.toggleMemberSummarySection=function(e){return this.showHide("memberDetailsExpandedContent_"+e,"collapsed","expanded"),this.changeDropDownArrow("dropDownArrow_"+e,"expanded"),!0},this.handleActionDropDown=function(e,s,r){return this.cancelEvent(e),this.toggleSelection("actionDropdown","actionDropdown_"+s,r,"active"),this.toggleCSSClass("actionButton","actionButton7_"+s,r,"actionDropdownAnchorHide","actionDropdownAnchorDisplay"),!1},this.showHide=function(e,s,t){r("#"+e).toggleClass(s),r("#"+e).toggleClass(t)},this.changeDropDownArrow=function(e,s){r("#"+e).toggleClass(s)},this.clearSearchResults=function(){null!=dojo.byId("registeredCustomersList_table")&&dojo.style("registeredCustomersList_table","display","none")},this.toggleSelection=function(e,s,t,o){var a=r("."+o,t);r("#"+s,t).toggleClass(o),a.removeClass(o)},this.resetPasswordByAdminOnBehalfForBuyers=function(e){wc.service.invoke("AjaxRESTMemberPasswordResetByAdminOnBehalfForBuyer",{logonId:e,URL:"test"})},this.resetPasswordByAdminOnBehalf=function(e){wc.render.getContextById("registeredCustomersSearchResultsContext");if(this.csrPasswordEnabled){var s=dojo.byId(this.csrResetPasswordIds.administratorPasswordId).value;if(null==s||""==s){var r=storeNLS.CSR_PASSWORD_EMPTY_MESSAGE;return this.onResetPasswordByAdminError(r),!1}wc.service.invoke("AjaxRESTMemberPasswordResetByAdminOnBehalf",{administratorPassword:s,logonId:e,URL:"test"})}else wc.service.invoke("AjaxRESTMemberPasswordResetByAdminOnBehalf",{logonId:e,URL:"test",authToken:document.getElementById("ResetPasswordAction_authToken").value})},this.resetPasswordByAdmin=function(e,s){wc.service.invoke("AjaxRESTMemberPasswordResetByAdmin",{administratorPassword:s,logonId:e,URL:"test"})},this.handleCSRPasswordReset=function(e){return this.cancelEvent(e),this.csrPasswordEnabled&&(dojo.byId(this.csrResetPasswordIds.administratorPasswordId).value=""),r("#"+this.csrResetPasswordIds.resetPasswordButtonId,this.csrResetPasswordIds.parentNodeId).toggleClass("clicked"),r("#"+this.csrResetPasswordIds.resetPasswordDropDownPanelId,this.csrResetPasswordIds.parentNodeId).toggleClass("active"),r("#"+this.csrResetPasswordIds.errorDivId,this.csrResetPasswordIds.parentNodeId).addClass("hidden"),!1},this.hideErrorDiv=function(){r("#"+this.csrResetPasswordIds.errorDivId,this.csrResetPasswordIds.parentNodeId).addClass("hidden")},this.onResetPasswordByAdminError=function(e,s){dojo.byId(this.csrResetPasswordIds.errorMessageId).innerHTML=e,r("#"+this.csrResetPasswordIds.errorDivId,this.csrResetPasswordIds.parentNodeId).removeClass("hidden"),dojo.byId(this.csrResetPasswordIds.errorMessageId).focus()},this.onResetPasswordByAdminSuccess=function(){return r("#"+this.csrResetPasswordIds.resetPasswordButtonId,this.csrResetPasswordIds.parentNodeId).toggleClass("clicked"),r("#"+this.csrResetPasswordIds.resetPasswordDropDownPanelId,this.csrResetPasswordIds.parentNodeId).toggleClass("active"),!1},this.handleErrorScenario=function(){var s=dojo.byId("errorMessage"),r=dojo.byId("errorMessage_section");if(null!=s){var t=s.value;null!=t&&""!=t.length&&null!=r&&(a.set(r,"display","block"),e.set(r,t))}else a.set(r,"display","none")},this.cancelEvent=function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.cancel=!0,e.returnValue=!1},this.closeActionButtons=function(e,s,t,o,a){r("."+e,s).removeClass(t)},this.resetActionButtonStyle=function(e,s,t,o){r("."+e,s).addClass(t),r("."+e,s).removeClass(o)},this.toggleCSSClass=function(e,s,t,o,a){var n=r("."+a,t);r("#"+s,t).toggleClass(o),r("#"+s,t).toggleClass(a),n.removeClass(a),n.addClass(o)},this.createGuestUser=function(e){var s=wc.render.getContextById("registeredCustomersSearchResultsContext");null!=e&&""!=e||stringStartsWith(document.location.href,"https")?(e=WCParamJS.homePageURL,s.properties.landingURL=e):s.properties.landingURL="";wc.service.invoke("AjaxRESTCreateGuestUser",[])},this.createRegisteredUser=function(e){null!=e&&(wc.render.getContextById("registeredCustomersSearchResultsContext").properties.landingURL=e);var s=[],r=dojo.byId("Register");null!=r.guestUserId&&null!=r.guestUserId.value&&(s.userId=r.guestUserId.value),dojo.destroy(r.errorViewName),wc.service.invoke("AjaxRESTUserRegistrationAdminAdd",s)},this.setUserInSession=function(e,s,r){var t=wc.render.getContextById("registeredCustomersSearchResultsContext");""!=s&&null!=s&&(t.properties.selectedUser=escapeXml(s,!0)),""!=r&&null!=r&&(t.properties.landingURL=r),t.properties.WC_OnBehalf_Role_="CSR";var o=[];o.runAsUserId=e,o.storeId=WCParamJS.storeId,o.authToken=document.getElementById("authToken").value,wc.service.invoke("AjaxRunAsUserSetInSession",o)},this.onUserSetInSession=function(){var e=wc.render.getContextById("registeredCustomersSearchResultsContext"),s=e.properties.selectedUser;""!=s&&null!=s&&setCookie("WC_BuyOnBehalf_"+WCParamJS.storeId,escapeXml(s,!0),{path:"/",domain:cookieDomain});var r=e.properties.WC_OnBehalf_Role_;""!=r&&null!=r&&setCookie("WC_OnBehalf_Role_"+WCParamJS.storeId,r,{path:"/",domain:cookieDomain})},this.enableDisableUserAccount=function(e,s){var r=wc.render.getContextById("UserRegistrationAdminUpdateStatusContext");r.properties.userId=e;var t=r.properties[e+"_updatedStatus"];null!=t&&(s="0"==t?"1":"0"),r.properties[e+"_userStatus"]=s,wc.service.invoke("AjaxRESTUserRegistrationAdminUpdateStatus",{userId:e,userStatus:s,authToken:document.getElementById("authToken").value})},this.onEnableDisableUserStatusAccount=function(e){var s=storeNLS.CUSTOMER_ACCOUNT_ENABLE_SUCCESS;"0"==e.userStatus&&(s=storeNLS.CUSTOMER_ACCOUNT_DISABLE_SUCCESS),MessageHelper.displayStatusMessage(s),onBehalfUtilitiesJS.updateUIAndRenderContext(e,"UserRegistrationAdminUpdateStatusContext")}}}),dojo.addOnLoad(function(){registeredCustomersJS=new RegisteredCustomers,registeredCustomersJS.setUpEvents()}),"undefined"!=typeof wc&&(wc.render.declareContext("registeredCustomersSearchResultsContext",{searchInitializedForCustomers:"false",isPaginatedResults:"false"},""),wc.render.declareRefreshController({id:"registeredCustomersController",renderContext:wc.render.getContextById("registeredCustomersSearchResultsContext"),url:"",baseURL:getAbsoluteURL()+"RegisteredCustomersListView",formId:"",modelChangedHandler:function(e,s){console.debug("modelChangedHandler of registeredCustomersController",s)},renderContextChangedHandler:function(e,s){this.url=this.baseURL+"?"+getCommonParametersQueryString();var r=this.renderContext;s.setInnerHTML(""),console.debug(r.properties),s.refresh(r.properties)},postRefreshHandler:function(e){registeredCustomersJS.handleErrorScenario(),console.debug("Post refresh handler of registeredCustomersController",e),cursor_clear()}}),wc.render.declareContext("UserRegistrationAdminUpdateStatusContext",{},""),wc.service.declare({id:"AjaxRESTUserRegistrationAdminUpdateStatus",actionId:"AjaxRESTUserRegistrationAdminUpdateStatus",url:getAbsoluteURL()+"AjaxRESTUserRegistrationAdminUpdate",formId:"",successHandler:function(e){registeredCustomersJS.onEnableDisableUserStatusAccount(e),cursor_clear()},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey)}}),wc.service.declare({id:"AjaxRunAsUserSetInSession",actionId:"AjaxRunAsUserSetInSession",url:getAbsoluteURL()+"AjaxRunAsUserSetInSession",formId:"",successHandler:function(e){if("undefined"!=typeof callCenterIntegrationJS&&void 0!=callCenterIntegrationJS&&null!=callCenterIntegrationJS){var s={status:"success"};s.serviceResponse=e,callCenterIntegrationJS.postActionMessage(s,"START_ON_BEHALF_SESSION_RESPONSE")}MessageHelper.hideAndClearMessage(),MessageHelper.displayStatusMessage(storeNLS.CSR_SUCCESS_CUSTOMER_ACCOUNT_ACCESS),registeredCustomersJS.onUserSetInSession(),setDeleteCartCookie();var r=wc.render.getContextById("registeredCustomersSearchResultsContext").properties.landingURL;"-1"!=r&&(window.location.href=r)},failureHandler:function(e){if("undefined"!=typeof callCenterIntegrationJS&&void 0!=callCenterIntegrationJS&&null!=callCenterIntegrationJS){var s={status:"error"};s.serviceResponse=e,callCenterIntegrationJS.postActionMessage(s,"START_ON_BEHALF_SESSION_RESPONSE")}e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey),cursor_clear()}}),wc.service.declare({id:"AjaxRESTCreateGuestUser",actionId:"AjaxRESTCreateGuestUser",url:getAbsoluteURL()+"AjaxRESTCreateGuestUser",formId:"",successHandler:function(e){MessageHelper.hideAndClearMessage(),MessageHelper.displayStatusMessage(storeNLS.CSR_SUCCESS_NEW_GUEST_USER_CREATION);var s=storeNLS.GUEST;registeredCustomersJS.setUserInSession(e.userId,s)},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey),cursor_clear()}}),wc.render.declareContext("UserRegistrationAdminAddContext",{administratorPassword:"",userId:""},""),wc.service.declare({id:"AjaxRESTUserRegistrationAdminAdd",actionId:"AjaxRESTUserRegistrationAdminAdd",url:getAbsoluteURL()+"AjaxRESTUserRegistrationAdminAdd",formId:"Register",successHandler:function(e){MessageHelper.hideAndClearMessage(),MessageHelper.displayStatusMessage(storeNLS.CSR_SUCCESS_NEW_REGISTERED_USER_CREATION),registeredCustomersJS.setUserInSession(e.userId,e.firstName+" "+e.lastName),cursor_clear()},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey),cursor_clear()}}));