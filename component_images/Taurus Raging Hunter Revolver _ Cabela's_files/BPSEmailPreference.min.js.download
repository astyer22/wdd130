"undefined"!=typeof wc&&wc.service.declare({id:"BPSAjaxEmailPreferenceUpdate",actionId:"BPSAjaxEmailPreferenceUpdate",url:"BPSAjaxEmailPreferenceUpdate",formId:"",successHandler:function(e){if(e.token){var r=dojo.byId("CMSubAuthUrl").value+e.email.toUpperCase()+"&idt="+e.token,a=document.createElement("iframe");a.setAttribute("src",r),a.id="CMEmailPrefFrame",a.name="CMEmailPrefFrame",a.style.display="block",dojo.byId("CMFrameWrapper").appendChild(a),dojo.byId("signup_guest_form").style.display="none"}else dojo.byId("signup_guest_form").style.display="";cursor_clear()},failureHandler:function(e){var r=document.getElementById("Email_Pref_Error_Div");e.errorMessage?r.innerHTML=e.errorMessage:e.errorMessageKey&&(r.innerHTML=e.errorMessageKey),cursor_clear()}}),BPSEmailPrefHelperJS={checkEmailId:function(e){var r=document.getElementById("Email_Pref_Error_Div");if(r.innerHTML="",!e&&!this.isValidEmail(dojo.byId("emailId").value))return r.innerHTML="Please enter a valid e-mail address.",!1;var a=[];a.storeId=WCParamJS.storeId,a.catalogId=WCParamJS.catalogId,a.langId=WCParamJS.langId,dojo.byId("emailId")&&(a.emailId=dojo.byId("emailId").value),cursor_wait(),wc.service.invoke("BPSAjaxEmailPreferenceUpdate",a)},checkEmailIdForNewAPI:function(e){var r=document.getElementById("Email_Pref_Error_Div");r.innerHTML="";var a=dojo.byId("emailId").value;if(""===a)return r.innerHTML="Please enter a valid e-mail address.",!1;if(!e&&!this.isValidEmail(a))return r.innerHTML="Please enter a valid e-mail address.",!1;var o=[];o.storeId=WCParamJS.storeId,o.catalogId=WCParamJS.catalogId,o.langId=WCParamJS.langId,dojo.byId("emailId")&&(o.emailId=dojo.byId("emailId").value);var i=dojo.byId("CM_PREF_CENTER_IFRAME_URL").value+a.toUpperCase(),l=document.createElement("iframe");l.setAttribute("src",i),l.id="CMEmailPrefFrame",l.name="CMEmailPrefFrame",l.style.display="block",dojo.byId("CMFrameWrapper").appendChild(l),dojo.byId("signup_guest_form").style.display="none"},isEmail:function(e){for(var r=1,a=e.length;r<a&&"@"!=e.charAt(r);)r++;if(r>=a||"@"!=e.charAt(r))return!1;for(r+=2;r<a&&"."!=e.charAt(r);)r++;return!(r>=a-1||"."!=e.charAt(r))},checkEmailIdForNewAPIFooter:function(e){var r=document.getElementById("Email_Pref_Error_Div");r.innerHTML="";var a=e.emailId.value;if(""===a)return r.innerHTML="Please enter a valid e-mail address.",!1;if(!this.isValidEmail(a))return r.innerHTML="Please enter a valid e-mail address.",!1;dojo.byId("s_email_address")&&(dojo.byId("s_email_address").value=a);try{cursor_wait(),dojo.xhrPost({url:dojo.byId("SubscribeEmailThirdPartyFooterForm").action,form:dojo.byId("SubscribeEmailThirdPartyFooterForm"),headers:{"X-Requested-With":null},load:function(r){console.log("FOOTER: email-sign-up Success"),cursor_clear(),e.submit()},error:function(e,a){console.log("FOOTER: email-sign-up Ajax Error"),console.log(e.message),console.log(e.responseText),cursor_clear(),r.innerHTML="Error while email sign-up"}})}catch(e){console.error("FOOTER: email-sign-up Error"),console.error(e),cursor_clear(),r.innerHTML="Error while email sign-up"}},enableSubscribeEmailFooterBtn:function(){if(dojo.byId("subscribeEmailFooterCheckBox")&&dojo.byId("subscribeEmailFooterCheckBoxErrorMsg")){var e=dojo.byId("subscribeEmailFooterCheckBox"),r=dojo.byId("subscribeEmailFooterCheckBoxErrorMsg");1==e.checked?(r.style.display="none",dojo.byId("bps_guest_email_submit").classList.remove("not-active"),dojo.byId("subscribeEmailFooterCheckBox").classList.remove("input-error")):(r.style.display="block",dojo.byId("bps_guest_email_submit").classList.add("not-active"),dojo.byId("subscribeEmailFooterCheckBox").classList.add("input-error"))}},checkEmailIdFooter:function(e){var r=document.getElementById("Email_Pref_Error_Div");r.innerHTML="";var a=e.emailId.value;if(!this.isValidEmail(a))return r.innerHTML="Please enter a valid e-mail address.",!1;var o=[];o.storeId=WCParamJS.storeId,o.catalogId=WCParamJS.catalogId,o.langId=WCParamJS.langId,a&&(o.emailId=a),cursor_wait(),wc.service.invoke("BPSAjaxEmailPreferenceUpdate",o)},isValidEmail:function(e){return e=e.trim(),!this.containsDoubleByte(e)&&(0==e.length||!(e.length<5)&&(!(e.indexOf(" ")>0)&&(!(e.indexOf("@")<1)&&(!(e.lastIndexOf(".")<e.indexOf("@")+2)&&(!(e.lastIndexOf(".")>=e.length-2)&&!!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/.test(e))))))},containsDoubleByte:function(e){for(var r=new String(e),a=0;a<r.length;a++)if(chr=r.charCodeAt(a),chr>127)return!0;return!1}};