dojo.require("wc.service.common"),dojo.require("wc.render.common"),wc.service.declare({id:"globalLoginAjaxLogon",actionId:"globalLoginAjaxLogon",url:getAbsoluteURL()+"AjaxLogon",formId:"",successHandler:function(e){cursor_clear();var a="",r="error",o="",t="true",n="false",s="false",l="false";if(null!=e.redirectTocart&&"false"==e.redirectTocart&&(o="false"),null!=e.redirecturl&&(e.redirecturl.indexOf("CustomerServiceLandingPageView")>0||null!=e.userType&&"R"!=e.userType)&&(t="false",n="true"),null!=e.redirecturl&&(e.redirecturl.indexOf("MilitaryNewVerification")>0||null!=e.pageFrom&&"military"==e.pageFrom)&&(t="false",s="true"),"ChangePassword"===e.redirecturl&&(t="false",l="true"),null!=e.state&&"updatepassword"==e.state)document.location.href=getAbsoluteURL()+"ResetPasswordGuestErrorView?state="+e.state+"&storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&krypto="+e.krypto+"&cabUser="+e.cabUser;else if(null!=e.ErrorCode){cursor_wait();var d=Number(e.ErrorCode);switch(d){case 2e3:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2000;break;case 2010:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2010;break;case 2020:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2020;break;case 2030:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2030;break;case 2110:document.location.href=getAbsoluteURL()+"ResetPasswordGuestErrorView?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&ErrorCode="+d+"&krypto="+e.krypto;break;case 2300:document.getElementById("bp-alert-textId")&&bpAlerts.destroyAlert(document.getElementById("bp-alert-error")),a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2300,r="warning";break;case 2340:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2340;break;case 2400:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2400;break;case 2410:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2410;break;case 2420:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2420;break;case 2430:case 2170:document.location.href="ResetPasswordForm?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&errorCode="+d;break;case 2570:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2570;break;case 2440:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2440;break;case 2450:a=MessageHelper.messages.GLOBALLOGIN_SIGN_IN_ERROR_2450}null!=document.getElementById(e.widgetId+"_logonErrorMessage_GL")&&(document.getElementById("bp-alert-textId")&&!document.getElementById("bps-signin-error-confirmationpage")||"2110"==e.ErrorCode||"2340"==e.ErrorCode||(bpAlerts.createAlert("","Header_GlobalLogin_logonErrorMessage_GL","after",r,"",a),document.getElementById(e.widgetId+"_WC_AccountDisplay_FormInput_logonId_In_Logon_1").setAttribute("aria-invalid","true"),document.getElementById(e.widgetId+"_WC_AccountDisplay_FormInput_logonId_In_Logon_1").setAttribute("aria-describedby","logonErrorMessage_GL_alt"),document.getElementById(e.widgetId+"_WC_AccountDisplay_FormInput_logonPassword_In_Logon_1").setAttribute("aria-invalid","true"),document.getElementById(e.widgetId+"_WC_AccountDisplay_FormInput_logonPassword_In_Logon_1").setAttribute("aria-describedby","logonErrorMessage_GL_alt"),cursor_clear())),null!=a&&null!=document.getElementById("guestOrderTrackingErrorMessage")&&"undefined"!=document.getElementById("guestOrderTrackingErrorMessage")&&(bpAlerts.createAlert("","guestOrderTrackingErrorMessage","after",r,"",a),cursor_clear())}else{var i=e.URL[0].replace(/&amp;/g,"&"),g=e.langId;if(null!=g&&null!=document.getElementById("langSEO"+g)){var c=document.location.href,I="/"+document.getElementById("currentLanguageSEO").value+"/";if(-1!=c.indexOf(I)){var u="/"+document.getElementById("langSEO"+g).value+"/",m=i.substring(i.indexOf("?")+1,i.length);if(null!=(w=dojo.queryToObject(m)).URL){var _=w.URL,L=_.substring(_.indexOf("?")+1,_.length),R=dojo.queryToObject(L);if(null!=R.URL){var O=R.URL;-1!=O.indexOf(I)&&(O=O.replace(I,u),R.URL=O),L=dojo.objectToQuery(R),_=_.substring(0,_.indexOf("?"))+"?"+L}else _=_.toString().replace(I,u);w.URL=_}m=dojo.objectToQuery(w),i=i.substring(0,i.indexOf("?"))+"?"+m}else if(i.contains("?")){var w;m=i.substring(i.indexOf("?")+1,i.length);if(null!=(w=dojo.queryToObject(m)).langId){w.langId=g;L=dojo.objectToQuery(w);i=i.substring(0,i.indexOf("?"))+"?"+L}else i=i+"&langId="+g}else i=i+"?langId="+g}"1"==e.MERGE_CART_FAILED_SHOPCART_THRESHOLD&&setCookie("MERGE_CART_FAILED_SHOPCART_THRESHOLD","1",{path:"/",domain:cookieDomain}),i.indexOf("?")>-1?i+="&logInEvent=1":i+="?logInEvent=1",window.localStorage.setItem("isLogin","true");var E=document.getElementById("GlobalLoginSwitch");null==E||void 0===E||"true"!=E.value||window.location.pathname.indexOf("/AjaxOrderItemDisplayView")>0||""!=o||"true"!=t?"false"==o?window.location=getAbsoluteURL()+"RESTOrderCalculate?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&logInEvent=1&krypto="+e.krypto+"&URL=OrderShippingBillingView&calculationUsageId=-1&updatePrices=1&doConfigurationValidation=Y&errorViewName=AjaxOrderItemDisplayView":"true"==n?window.location=getAbsoluteURL()+"RESTOrderCalculate?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&logInEvent=1&krypto="+e.krypto+"&URL=CustomerServiceLandingPageView&calculationUsageId=-1&updatePrices=1&doConfigurationValidation=Y&errorViewName=AjaxOrderItemDisplayView":"true"==s?window.location=getAbsoluteURL()+"RESTOrderCalculate?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&logInEvent=1&krypto="+e.krypto+"&URL=MilitaryNewVerification&calculationUsageId=-1&updatePrices=1&doConfigurationValidation=Y&errorViewName=AjaxOrderItemDisplayView":"true"===l?(console.log("Change password scenario"),window.location=getAbsoluteURL()+"ResetPasswordForm?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&errorCode="+d):window.location=i:window.location.pathname.indexOf("/UserRegistrationForm")>0&&"true"!=n&&"true"!=s?window.location=getAbsoluteURL()+"AjaxLogonForm?myAcctMain=1&storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&logInEvent=1":window.location.pathname.indexOf("/ResetPasswordGuestErrorView")>0&&"true"!=n&&"true"!=s?window.location=getAbsoluteURL()+"AjaxLogonForm?myAcctMain=1&storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&logInEvent=1":window.location.pathname.indexOf("/AjaxLogonForm")>0&&"true"!=n&&"true"!=s?window.location=getAbsoluteURL()+"AjaxLogonForm?myAcctMain=1&storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&logInEvent=1":i!=window.location+"&logInEvent=1"&&i!=window.location+"?logInEvent=1"||null==e.redirecturl||-1!=e.redirecturl.indexOf("ResetPasswordGuestErrorView")||window.location.reload()}},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey),cursor_clear()}});