dojo.require("wc.service.common"),dojo.require("dijit.registry"),shoppingActionsServicesDeclarationJS={langId:"-1",storeId:"",catalogId:"",setCommonParameters:function(e,r,s){this.langId=e,this.storeId=r,this.catalogId=s}},wc.service.declare({id:"RemoveOrderItem",actionId:"RemoveOrderItem",url:getAbsoluteURL()+"AjaxRESTOrderItemDelete",formId:"",successHandler:function(e){if(null!=e.itemToAdd&&""!=e.itemToAdd){var r=[];r.storeId=e.storeId,r.catalogId=e.catalogId,r.langId=e.langId,null!=e.personalization&&(r.personalization=e.personalization);var s=e.itemToAdd[0].split(","),o=e.itemToAddQty[0].split(",");if(s.length>1&&o.length>1)for(var t=0;t<s.length;t++)r["catEntryId_"+(t+1)]=s[t],r["quantity_"+(t+1)]=o[t];else r.catEntryId=e.itemToAdd,r.quantity=e.itemToAddQty,void 0!==e.itemToAddFrequency&&null!=typeof e.itemToAddFrequency&&(r.subscriptionFrequency=e.itemToAddFrequency);r.orderId=".",r.calculationUsage="-1,-2,-5,-6,-7",r.calculateOrder="1","gunInCart"==e.fromErrorType||"shipToStoreOnlyCart"==e.fromErrorType?"wishlist"==e.fromPage?wc.service.invoke("AjaxAddOrderItem",r):"myaccount"==e.fromPage?(wc.service.getServiceById("OrderHistoryReorder").url=dojo.byId("ReorderCSR").getAttribute("data-reorderurl"),wc.service.invoke("OrderHistoryReorder")):wc.service.invoke("AddOrderItem",r):"dropShipOrGiftInCart"!=e.fromErrorType&&"shipToAddressOnlyCart"!=e.fromErrorType&&"corrupted"!=e.fromErrorType||FirearmAgreementJS.agreeAndAddToCart(document.getElementById("onlineFirearmOrderingAgreement"))}},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey),e.errorCode&&dojo.publish("OrderError",e),cursor_clear()}}),wc.service.declare({id:"SaveForLaterListServiceRemoveItem_Firearm",actionId:"SaveForLaterListServiceRemoveItem",url:getAbsoluteURL()+"AjaxRestWishListRemoveItem",formId:"",successHandler:function(e){console.log(e)},failureHandler:function(e){console.log(e)}}),wc.service.declare({id:"AddOrderItem",actionId:"AddOrderItem",url:getAbsoluteURL()+"AjaxRESTOrderItemAdd",formId:"",successHandler:function(e){if(dojo.require("dijit.registry"),MessageHelper.hideAndClearMessage(),cursor_clear(),void 0!=e.isGun&&"true"==e.isGun[0]&&void 0!=e.orderItem&&void 0!=e.physicalStoreId){e.orderItem[0].orderItemId;var r=e.physicalStoreId[0];e.orderId;"undefined"!=typeof FirearmAgreementJS&&FirearmAgreementJS.updatePhysicalStoreAddressForOrder(r)}if(shoppingActionsJS){var s=dojo.query('div[id^="attrValue_"]');if(null!=dojo.query(".definingAttributes")[0])s=dojo.query(".definingAttributes");else if(null!=dojo.query(".product_sizes")[0])s=dojo.query(".product_sizes");else if(null!=dojo.query(".product_info")[0])s=dojo.query(".product_info");for(var o=new Array,t=0;t<s.length;t++)for(var a=s[t].querySelectorAll(".dijitSelect"),i=0;i<a.length;i++)o=o.concat(a[i]);var d=new Array;for(t=0;t<o.length;t++)d[t]=dijit.registry.byNode(o[t]);var l=!0;for(t=0;t<d.length;t++)d[t].options.length>2&&(l=!1);if(!l){shoppingActionsJS.selectedAttributes=new Object,dojo.topic.publish("DefiningAttributes_Resolved_"+shoppingActionsJS.baseCatalogEntryId,shoppingActionsJS.baseCatalogEntryId,-1);for(t=0;t<d.length;t++)null!=d[t]&&(d[t].value="")}}if(null!=typeof ShipmodeSelectionExtJS&&"undefined"!=typeof ShipmodeSelectionExtJS&&void 0!=e.orderItemId&&ShipmodeSelectionExtJS.setOrderItemId(e.orderItemId[0]),void 0!=e.savedForlaterItemId&&void 0!=e.savedForlaterListId&&""!=e.savedForlaterListId[0]&&""!=e.savedForlaterItemId[0]){var n=[];n.storeId=WCParamJS.storeId,n.catalogId=WCParamJS.catalogId,n.langId=WCParamJS.langId,n.giftListId=e.savedForlaterListId[0],n.giftListItemId=e.savedForlaterItemId[0],n.callRefresh="NO",n.itemName="",wc.service.invoke("SaveForLaterListServiceRemoveItem_Firearm",n)}dojo.publish("ProductAddedToCart"),dojo.byId("grayOut").style.display="block"},failureHandler:function(e){if(e.errorMessage)if("_ERR_NO_ELIGIBLE_TRADING"==e.errorMessageKey)MessageHelper.displayErrorMessage(storeNLS.ERROR_CONTRACT_EXPIRED_GOTO_ORDER);else if("_ERR_RETRIEVE_PRICE"==e.errorMessageKey){var r=storeNLS.GENERICERR_MAINTEXT;r=dojo.string.substitute(r,{0:storeNLS.GENERICERR_CONTACT_US}),MessageHelper.displayErrorMessage(r)}else"gunInCart"==e.errorMessageKey||"dropShipOrGiftInCart"==e.errorMessage||"corrupted"==e.errorMessage||"shipToStoreOnlyCart"==e.errorMessage||"shipToAddressOnlyCart"==e.errorMessage?MessageHelper.displayErrorMessage(e):MessageHelper.displayErrorMessage(e.errorMessage);else e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey);e.errorCode&&dojo.publish("OrderError",e),cursor_clear(),dojo.byId("grayOut").style.display="block"}}),wc.service.declare({id:"AddPreConfigurationToCart",actionId:"AddOrderItem",url:getAbsoluteURL()+"AjaxRESTOrderAddPreConfigurationToCart",formId:"",successHandler:function(e){if(MessageHelper.hideAndClearMessage(),cursor_clear(),shoppingActionsJS){for(var r=document.getElementsByName("attrValue"),s=!0,o=0;o<r.length;o++)r[o].options.length>1&&(s=!1);if(!s){shoppingActionsJS.selectedAttributes=new Object;for(o=0;o<r.length;o++)null!=r[o]&&(r[o].value="",r[o].onchange())}}null!=typeof ShipmodeSelectionExtJS&&"undefined"!=typeof ShipmodeSelectionExtJS&&ShipmodeSelectionExtJS.setOrderItemId(e.orderItemId[0])},failureHandler:function(e){if(e.errorMessage)if("_ERR_NO_ELIGIBLE_TRADING"==e.errorMessageKey)MessageHelper.displayErrorMessage(storeNLS.ERROR_CONTRACT_EXPIRED_GOTO_ORDER);else if("_ERR_RETRIEVE_PRICE"==e.errorMessageKey){var r=storeNLS.GENERICERR_MAINTEXT;r=dojo.string.substitute(r,{0:storeNLS.GENERICERR_CONTACT_US}),MessageHelper.displayErrorMessage(r)}else MessageHelper.displayErrorMessage(e.errorMessage);else e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey);cursor_clear()}}),wc.service.declare({id:"POSTMailOptStatus",actionId:"POSTMailOptStatus",url:getAbsoluteURL()+"AjaxMarketingMailToggle",formId:"",successHandler:function(e){},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey)}}),wc.service.declare({id:"POSTSiteCorrespondenceMail",actionId:"POSTSiteCorrespondenceMail",url:getAbsoluteURL()+"AjaxSiteCorrespondenceMail",successHandler:function(e){"WishList"==e.correspondType&&(1==e.success?(MessageHelper.hideAndClearMessage(),shoppingListJS.showMessageDialog(storeNLS.WISHLIST_EMAIL_SENT),dojo.byId("WishListEmailSucMsg_Div").style.display="block",dojo.byId("WishListEmailSucMsg_Div").style.wordWrap="break-word"):(MessageHelper.displayErrorMessage("There was an error processing your request. Please try again later."),restoreBodyScroll()))},failureHandler:function(e){e.errorMessage?MessageHelper.displayErrorMessage(e.errorMessage):e.errorMessageKey&&MessageHelper.displayErrorMessage(e.errorMessageKey),void 0!=e&&"WishList"==e.correspondType&&restoreBodyScroll()}}),wc.service.declare({id:"AjaxVerifyCaptchaV3Response",actionId:"AjaxVerifyCaptchaV3Response",url:getAbsoluteURL()+"AjaxRESTVerifyCaptchaV3Response",formId:"",successHandler:function(e){e&&void 0!=e.captchaResponse&&console.log("Recaptcha verified... "+e.captchaResponse.success)},failureHandler:function(e){console.log("Recaptcha verified failed... "+e.errorMessage)}});