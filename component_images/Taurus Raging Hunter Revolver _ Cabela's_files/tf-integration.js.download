(()=>{"use strict";var e,t;const n="undefined"!=typeof self?self:globalThis,i=null!==(e=n.window)&&void 0!==e?e:{},r=null!==(t=n.document)&&void 0!==t?t:{},o={NODE_ENV:"production",PUBLIC_URL:void 0,WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,TFP_APP_DIST_PUBLIC_URL:"/consumer-ux/7.0-latest-202310251300.123/tfp-app",TF_INTEGRATION_UX_VERSION:"7.0-latest-202310251300.123"};var a,s;function c(e){if(""===(e=e||r.location.hostname)||"localhost"===e)return;const t=/(^[^.]+$)|([^.]+\.((?:com|net|org|[^.]{2})\.)?(?:[^.]+|vercel\.app|myshopify\.com)\.?$)/.exec(e);if(t)return t[0];console.error("Could not parse parent domain from domain "+e)}function d(){return(new Date).getTime()}function l(e){const{name:t,value:n,domain:i,sameSite:o}=e;let{maxAge:a}=e,s=`${t}=${n}`;i&&(s+=`;domain=${i}`),s+=";path=/",null!=a&&(a<0&&(a=0),s+=`;max-age=${a.toFixed()}`),s+=";secure",s+=o?`;samesite=${o}`:";samesite=strict",r.cookie=s}function f(e){var t;return null===(t=r.cookie.split(";").find((t=>t.trim().startsWith(`${e}=`))))||void 0===t?void 0:t.split("=")[1]}function u(e){let t=0;return r.cookie.split(";").forEach((n=>{n.trim().startsWith(`${e}=`)&&t++})),t}!function(e){e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR"}(a||(a={})),function(e){e[e.TRACE=1]="TRACE",e[e.DEBUG=2]="DEBUG",e[e.INFO=3]="INFO",e[e.WARN=4]="WARN",e[e.ERROR=5]="ERROR",e[e.OFF=6]="OFF"}(s||(s={}));const p="tfc-l";function g(e,t){b("k",e,t)}function h(){return E("k")}function m(){if(f(p))return!0;b("t","x",3600);const e="x"===E("t");return e&&I("t"),e}function y(){const e=f(p);return e?JSON.parse(decodeURIComponent(e)):{}}function v(e){const t=encodeURIComponent(JSON.stringify(e)),{cookieSameSiteNone:n}=H(),i=c();l({name:p,value:t,domain:i,maxAge:31536e4,sameSite:n?"none":"strict"}),u(p)>1&&function(e){const t=c(e=e||r.location.hostname);if(null==t)return[];{let n=[];e!==t&&(n=e.substring(0,e.lastIndexOf(t)-1).split("."));let i=t;const r=[i];return n.reverse().forEach((e=>{r.push(i=e+"."+i)})),r}}().forEach((e=>{var t;e!==i&&(t={name:p,domain:e},l(Object.assign(Object.assign({},t),{value:"",maxAge:0})))})),u(p)>1&&F.error("More than one tfc-l cookie found after trying to clean up.")}function b(e,t,n){const i=y();i[e]={v:t,e:O()+n},v(i)}function w(e){const t=y()[e];if(t)return t.e<O()?void I(e):t}function E(e){var t;return null===(t=w(e))||void 0===t?void 0:t.v}function I(e){const t=y();delete t[e],v(t)}function O(){return Math.floor((new Date).getTime()/1e3)}var k=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};function T(){const{storeKey:e}=H();return e}function $(){const{cdnOrigin:e}=H();return o.TF_INTEGRATION_SERVICE_ORIGIN||e}function x(e,t){return k(this,void 0,void 0,(function*(){return h()||(yield fetch(`${e}/profile/public/v3/${t}/token`,{credentials:"include"}).then((e=>e.json().then((e=>(g(e.token,63072e3),Promise.resolve(e.token)))))))}))}const R="true"===o.TFP_INTEGRATION_CONSOLE_LOGGER,S=o.TF_INTEGRATION_LOGGING_LEVEL;function j(){var e;return null!==(e=i.tfcLoggingLevel)&&void 0!==e?e:s.WARN}S&&(i.tfcLoggingLevel=s[S]);let A=[];function W(){return e=this,t=void 0,i=function*(){if(A.length){const e=A.slice();A=[],yield function(e){return k(this,void 0,void 0,(function*(){const t=$(),n=T(),i=yield x(t,n),r={};r["X-TF-UserToken"]=i,yield fetch(`${t}/profile/public/v3/${n}/client-log`,{headers:Object.assign(Object.assign({},r),{"content-type":"application/json; charset=UTF-8"}),body:JSON.stringify({clientLogs:e}),method:"POST"})}))}(e)}},new((n=void 0)||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}));var e,t,n,i}const N=function(e,t,n){let i,r,o,a,s=0;n||(n={});const c=function(){s=!1===n.leading?0:d(),i=null,a=e.apply(r,o),i||(r=null,o=[])},l=function(...t){const l=d();s||!1!==n.leading||(s=l);const f=1e3-(l-s);return r=this,o=t,f<=0||f>1e3?(i&&(clearTimeout(i),i=null),s=l,a=e.apply(r,o),i||(r=null,o=[])):i||!1===n.trailing||(i=setTimeout(c,f)),a};return l.cancel=function(){i&&clearTimeout(i),s=0,i=r=null,o=[]},l}(W,0,{leading:!1});function C(e,...t){console.error(e,...t);const{stack:n,message:i}=e instanceof Error?e:new Error(`${e}`);A.push({level:a.ERROR,message:`${i}`,stack:n})}const F=Object.assign({trace:(e,...t)=>{j()<=s.TRACE&&console.trace(e,...t)},debug:(e,...t)=>{j()<=s.DEBUG&&console.debug(e,...t)},info:(e,...t)=>{j()<=s.INFO&&console.info(e,...t)},warn:(e,...t)=>{j()<=s.WARN&&(console.warn(e,...t),A.push({level:a.WARN,message:e}),N())},error:(e,...t)=>{j()<=s.ERROR&&(C(e,...t),N())},error_consoleOnly:(e,...t)=>{j()<=s.ERROR&&console.error(e,...t)},raise:(e,...t)=>{const n=new Error(e);throw R?console.error(n):j()<=s.ERROR&&(C(n,...t),W()),n}},R?console:{});let _=null;const P={locale:!1,userId:!1,registered:!1,widgetHidden:!1,storeExperimentKey:!1};function H(){if(null===_)throw"TF integration library needs to be initialized. Use truefit.init.";return _}function L(e,t=!0,n=!1){if(null===_)throw"TF integration library needs to be initialized. Use truefit.init.";const i=Object.assign({},_);["locale","userId","registered","widgetHidden","storeExperimentKey"].forEach((r=>{const o=e[r],a=i[r];void 0!==o&&t&&!n&&(P[r]=!0,i[r]=o),void 0===o||void 0!==a&&(n||P[r])||(i[r]=o)})),_=i}function U(e){const t=/\(([^)]*)\)$/;function n(e){const t=e.match(/'([^']*)'/);return t&&t[1]}try{const i=e.split(".").reduce((function(e,i){if(null==e)return;const r=i.match(t);if(!r)return e[i];{const t=e[i.slice(0,-r[0].length)];if("function"==typeof t)return t(...r[1].split(",").map(n))}}),window);if("string"==typeof i)return i}catch(t){F.error(`Error while trying to get provider ID from window. Path: ${e}`,t)}}let z=null;const K=[function(e){var t;"large"===e.newSize&&(Ke(),Ye()),Xe(e.newSize);const n=Qe(),i="small"===e.newSize?"large":"small";r.body.classList.remove(`tfc-${i}-screen`),r.body.classList.add(`tfc-${e.newSize}-screen`),null===(t=null==n?void 0:n.contentWindow)||void 0===t||t.postMessage(e,Me)}];let M=null;const D=e=>{const t=e.matches?"small":"large";z=t,K.forEach((e=>{e({type:"screenSizeChange",newSize:t})}))};function G(){if(null===z)throw"ResponsiveManager has not been initialized";return z}function q(){if(null===z)throw"ResponsiveManager has not been initialized";const{deviceType:e}=H();return"responsive"===e?"small"===z?"mobile":"desktop":e}const B=["userId","registered","locale","widgetHidden","storeExperimentKey","configOverride","configSet","colorId"],V=e=>e.split("&").reduce(((e,t)=>Object.assign(Object.assign({},e),(([e,t])=>e&&t&&e.startsWith("tfc-")?{[e]:t}:{})(t.split("=")))),{}),J=new Map,X=()=>{for(const[e,t]of J)t.iframe.isConnected||J.delete(e)},Y=(e,t)=>e.reduce(((e,n)=>n instanceof HTMLElement?(e.push(n),e):(F.error(`A ${t} widget was found on an unsupported element:`,n),e)),[]),Z=()=>Y([...r.querySelectorAll(".tfc-fitrec-register")],"tfc-fitrec-register"),Q=()=>Y([...r.querySelectorAll(".tfc-fitrec-size-sampling")],"tfc-fitrec-size-sampling"),ee=()=>Y([...r.querySelectorAll(".tfc-fitrec-rollup")],"tfc-fitrec-rollup"),te=()=>Y([...r.querySelectorAll(".tfc-order-notify")],"tfc-order-notify"),ne=()=>{const e=Y([...r.querySelectorAll(".tfc-fitrec-product")].filter((e=>{const t=e.getAttribute("data-widgetlocation");return!t||"A"===t})),"tfc-fitrec-product");return e.forEach((e=>{const{dataset:{styleid:t,iframeid:n}}=e;if(!t&&n)for(delete e.dataset.iframeid,J.delete(n);e&&e.firstChild;)e.removeChild(e.firstChild)})),e},ie=()=>[...ne(),...Z(),...te(),...Q()];function re(e){const t=H(),n=Object.entries((({hash:e,search:t}=r.location)=>Object.assign(Object.assign({},e.startsWith("#")?V(e.slice(1)):{}),t.startsWith("?")?V(t.slice(1)):{}))()).reduce(((e="",[t,n],i)=>`${i?`${e}&`:""}${t.slice(4)}=${n}`),void 0);return Object.assign({tfIntegrationVersion:o.TF_INTEGRATION_UX_VERSION,type:e,retailerHref:i.location.href,retailerOrigin:i.location.origin,deviceType:t.deviceType,screenSize:G(),integrationPlatform:"web",cookiesEnabled:m(),token:h(),storeKey:t.storeKey,locale:t.locale,userId:t.userId,registered:t.registered,widgetHidden:t.widgetHidden,storeExperimentKey:t.storeExperimentKey},n?{sessionParamOverrides:n}:{})}const oe=(e={})=>t=>{const n=Object.assign({colorId:"colorid",configSet:"configset",iframeId:"iframeid",styleId:"styleid",userId:"userid"},e);return t in n?n[t]:t},ae=oe(),se=oe({widgetHidden:"widget-hidden",storeExperimentKey:"store-experiment-key"});function ce(e,t,n){const i=Math.random().toString(36).substring(2),o=r.createElement("iframe"),{type:a}=e,s=Object.entries(e).reduce(((e,[t,n])=>`${e}${null!=n?`&${t}=${encodeURIComponent(n)}`:""}`),`iframeId=${i}`),{iframeWidgetUrl:c,cdnOrigin:d,widgetHidden:l}=H();o.src=`${c}#${s}`,o.title="True Fit Widget",t&&(o.dataset.elementId=`widget-iframe-${t}`),o.style.display=l||"api"===a?"none":"block",o.style.height="0",o.style.width="100%",o.style.border="0",n&&(n.dataset.iframeid=i);const f=t?`${a}-${t}`:a;return F.debug(`added iframe widget to the page for widget ${t} and src ${d}`,performance.now()),J.set(i,{type:a,iframe:o,loaded:!1,queuedMessages:[]}),o.addEventListener("load",(e=>{const t=J.get(i);t?(t.queuedMessages.forEach((e=>{ze(t,e,i)})),J.set(i,Object.assign(Object.assign({},t),{loaded:!0,queuedMessages:[]})),F.debug(`iframe widget for style ${f} load event`,e,performance.now())):F.warn(`Iframe id=${i} loaded, but the widget was no longer found.`)})),(n||r.body).appendChild(o),[i,o]}const de=["locale","userId","registered","widgetHidden","storeExperimentKey"],le=e=>({locale:e.locale,userId:e.userid,registered:void 0===e.registered?void 0:"true"===e.registered,widgetHidden:void 0===e.widgetHidden?void 0:"true"===e.widgetHidden,storeExperimentKey:e.storeExperimentKey});function fe(e){const{locale:t,userId:n,widgetHidden:i,storeExperimentKey:r}=e,o={locale:t,userId:n,widgetHidden:i,storeExperimentKey:r};for(const{dataset:e,id:t}of ie()){const n=le(e);for(const[i,r]of Object.entries(o)){const o=ae(i),a=n[o];null!=a&&null!=r&&a!==r&&(F.warn(`Attributes for key "data-${se(i)}" mismatch. Old=${a} New=${r} WidgetId=${t}. Removing the data attribute from the element.`),delete e[o])}}}function ue(){const e=ie();for(const t of de){const n=new Set(e.map((e=>e.dataset[ae(t)])));n.size>1&&F.warn(`Multiple different attribute values detected for data-${se(t)}: `+Array.from(n).join(", "))}}const pe=({dataset:e})=>{L(le(e),!1,!0)},ge=e=>({dataset:{context:t,styleid:n,colorid:i,configset:r,configOverride:o}})=>{const a="tfc-fitrec-rollup"===e?"rollup":t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({type:e},n?{style:n}:{}),i?{colorId:i}:{}),a?{context:a}:{}),r?{configSet:r}:{}),o?{configOverride:o}:{})},he=(e,t)=>e.reduce(((e,n)=>n===t?e:[...e,ge("tfc-fitrec-product")(n)]),[]),me=(e=Z())=>e.map(ge("tfc-fitrec-register")),ye=(e=ee())=>e.map((e=>ge("tfc-fitrec-rollup")(e))),ve=({element:e,productWidgetEls:t,bannerWidgetEls:n,rollupWidgetEls:i})=>JSON.stringify([...he(t,e),...me(n),...ye(i)]);let be;function we(){return X(),be&&!J.has(be)&&(be=void 0),be}function Ee(){return X(),J.keys().next().value}const Ie=e=>{const t=null==e?void 0:e.dataset.iframeid;return t&&J.has(t)};function Oe({productWidgetEls:e=ne(),bannerWidgetEls:t=Z(),rollupWidgetEls:n=ee()}={}){const i=we(),r=i&&e.some((e=>e.dataset.iframeid===i))?i:(o=null==(a=e.find(Ie))?void 0:a.dataset.iframeid,be=o);var o,a;const s=r&&e.find((e=>e.dataset.iframeid===r));if(r&&s)return i!==r&&F.debug(`ensureRequesterId - Promoting iframe ${r} to requester.`),Ue(r,{type:"updateOtherWidgets",otherWidgets:ve({element:s,productWidgetEls:e,bannerWidgetEls:t,rollupWidgetEls:n})}),r;F.trace("ensureRequesterId - No requester iframe found")}function ke(e){const t=Array.from(J.keys()),n=[],i=ne(),r=Z(),o=ee();Oe({bannerWidgetEls:r,productWidgetEls:i,rollupWidgetEls:o}),i.forEach((t=>{var a;const s=t.dataset,c=s.styleid||t.id;if(!c)return void F.warn("tfc-fitrec-product widget found without a data-styleid attribute - skipping",t);s.styleid||(s.styleid=c),pe(t);const d=H();if(!s.iframeid)return void function(e,t,n,i,r){const{context:o,colorid:a,configset:s,configOverride:c}=e.dataset;F.debug("No data-iframeid found. Creating a product widget iframe...");const d=we(),l=n.length+i.length+r.length,f=d&&l>1?null:ve({element:e,productWidgetEls:n,bannerWidgetEls:i,rollupWidgetEls:r}),u=Object.assign(Object.assign(Object.assign({},re("tfc-fitrec-product")),{styleId:t,context:o,colorId:a,configSet:s,configOverride:c}),f?{otherWidgets:f}:{}),[p]=ce(u,t,e);we()||(be=p)}(t,c,i,r,o);const l=null===(a=J.get(s.iframeid))||void 0===a?void 0:a.iframe;l&&(d.widgetHidden?l.style.display="none":l.style.display="block"),F.debug("data-iframeid found. Updating variables and refreshing the widget..."),n.push(s.iframeid);const f=Te(s);Ce(s.iframeid,f,!!e&&s.iframeid===e,c)})),t.filter((e=>!n.includes(e))).forEach((e=>{var t;"tfc-fitrec-product"===(null===(t=J.get(e))||void 0===t?void 0:t.type)&&J.delete(e)}))}function Te(e){const t=H(),n={};return B.forEach((i=>{const r=ae(i),o=void 0!==t[i]?t[i]:null==e?void 0:e[r];void 0!==o&&""!==o&&(n[i]=o)})),n}function $e(){const e=Z();e.length&&(e.forEach(pe),function(e){if(Oe())return;const t=Ee();t?(Ue(t,{type:"updateOtherWidgets",otherWidgets:ve({productWidgetEls:[],bannerWidgetEls:e,rollupWidgetEls:[]})}),Ce(t,Te(),!1)):Pe({otherWidgets:JSON.stringify([...me(e)])})}(e))}function xe(e){const t=Q();t.length&&t.forEach((t=>{const n=t.dataset;pe(t);const i=Te(n);n.iframeid&&Ce(n.iframeid,i,!!e&&n.iframeid===e)}))}function Re(e){const t=ee();t.length&&t.forEach((t=>{const n=t.dataset,i=n.styleid;if(n.context="rollup",!i)return void F.warn("tfc-fitrec-rollup widget found without a data-styleid attribute - skipping",t);n.styleid||(n.styleid=i),pe(t);const r=Te(n);n.iframeid?Ce(n.iframeid,r,!!e&&n.iframeid===e):function(e,t){F.debug("No data-iframeid found. Creating a rollup widget iframe...");const n=ne(),i=Z(),r=ee(),o=we(),a=n.length+i.length,s=o&&a>1?null:ve({element:e,productWidgetEls:n,bannerWidgetEls:i,rollupWidgetEls:r});ce(Object.assign(Object.assign(Object.assign({},re("tfc-fitrec-rollup")),{styleId:t}),s?{otherWidgets:s}:{}),void 0,e)}(t,i)}))}function Se(e={}){const t=te(),[n,...i]=t;if(!n)return;i.length&&F.error(`Found ${t.length} tfc-order-notify widgets. Only processing first.`),pe(n);const{orderId:r=n.dataset.orderid}=e;r?He({checkoutType:"OrderNotify",orderId:r}):F.error(new Error("orderId is missing"))}let je,Ae=[];function We(e){ke(e),Se(),$e(),xe(e),Re(e)}function Ne(e){const{products:t,orderId:n}=e;t&&(ne().forEach((e=>{const n=e.dataset,i=n.styleid||e.id;if(!i)return;const r=t[i];r&&r.colorId&&(n.colorid=r.colorId)})),ke()),Se({orderId:n}),$e(),xe(),Re()}function Ce(e,t,n,i){Ue(e,Object.assign(Object.assign({type:"widgetRefresh",currentWidget:t},i?{styleIdForCurrentWidget:i}:{}),{immediateOpen:n}))}function Fe(e){Le({type:"tokenUpdate",token:e})}function _e(e){const t=H();["userId","locale","widgetHidden","storeExperimentKey"].forEach((n=>{var i;const r=null!==(i=e[n])&&void 0!==i?i:t[n];void 0!==r&&(e[n]=r)}))}function Pe(e){ce(Object.assign(Object.assign(Object.assign({},re("api")),{type:"api"}),e))}function He(e){var t;const n=Ee(),i=q(),r=Object.assign(Object.assign({},e),{deviceType:null!==(t=e.deviceType)&&void 0!==t?t:i,integrationPlatform:"web"});_e(r),n?Ue(n,{type:"checkout",checkout:r}):Pe({checkout:JSON.stringify(r)})}function Le(e){J.forEach(((t,n)=>{Ue(n,e)}))}function Ue(e,t){const n=J.get(e);n?n.loaded?ze(n,t,e):n.queuedMessages.push(t):F.debug(`Tried to send event ${t.type} but no widget was found.`)}function ze(e,t,n){if(!e.iframe.parentElement)return void F.error(`Iframe for widget type "${e.type}" with iframeId "${n}" was detached. Not posting message with event type "${t.type}" to the widget.`);const i=e.iframe.contentWindow;null==i||i.postMessage(t,H().cdnOrigin)}function Ke(e=!1){je&&i.scroll(je.scrollX,je.scrollY),e&&(je=void 0)}let Me,De=!1,Ge=null;const qe=i.history,Be={tfcModalVisible:!0},Ve=e=>{F.debug("tfModal - closing TF due to popstate event",e),et("backButton")},Je="tfc-viewport";function Xe(e){if("small"===e&&!r.head.querySelector("#tfc-viewport")){const e=r.createElement("meta");e.setAttribute("id",Je),e.setAttribute("name","viewport");const t=De?"width=device-width, initial-scale=1.0, viewport-fit=cover":"width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover";e.setAttribute("content",t),r.head.append(e)}}function Ye(){const e=r.head.querySelector("#tfc-viewport"),t=[];r.head.querySelectorAll('meta[name="viewport"]').forEach((e=>{e.id!==Je&&t.push(e)}));const n=t[0];e&&(e.setAttribute("content",(null==n?void 0:n.getAttribute("content"))||""),r.head.removeChild(e))}function Ze(){var e;Ge&&(clearTimeout(Ge),Ge=null),(null===(e=qe.state)||void 0===e?void 0:e.tfcModalVisible)&&qe.back(),i.removeEventListener("popstate",Ve);const t=r.body;t.classList.remove("tfc-show-modal"),t.classList.remove("tfc-small-screen"),t.classList.remove("tfc-large-screen"),"small"===G()&&Ke(!0),Ye();const n=Qe();null==n||n.remove()}function Qe(){const e=r.getElementById("tfc-app-iframe");if(e instanceof HTMLIFrameElement)return e}function et(e){var t;Ge=i.setTimeout((()=>{Ge=null,Ze()}),500);const n=Qe(),r={type:"requestClose",reason:e};null===(t=null==n?void 0:n.contentWindow)||void 0===t||t.postMessage(r,Me)}function tt(e,t){const{mayReprocessWidgets:n=!0}=null!=t?t:{},{widgetToken:o,iframeId:a,iframeOrigin:s,iframePathAndHash:c,mobileModalSize:d,partialModalHeightStyleVal:l}=e,f=h(),u=f||o;if(u){if(u!==f&&(F.debug("Integration token doesn't match the widget token. Writing widget token to the cookie."),g(u,63072e3),h()!==u))return void F.error("True Fit cookie isn't persisting - widget should not have rendered. Not opening the app");Fe(u)}if(n&&(!u||f!==o))return F.debug(u?"Integration token mismatches widget token.":"Latest token is missing.","Reprocessing widgets with an immediate open id."),void We(a);const p=(m="tfpAppConfigOverrides",function(e){if(e)try{return JSON.parse(e)}catch(e){console.error("Error parsing json."),console.error(e)}}(localStorage.getItem(m)));var m,y,v;!function(e,t,n=!1,o){Me=e,je={scrollY:i.scrollY,scrollX:i.scrollX},function(){if(!r.getElementById("tfc-full-screen-container")){!function(){const e=r.createElement("style");e.textContent="\n  #tfc-full-screen-container {\n    display: none;\n    position: fixed;\n    overflow-y: auto;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 100%;\n    z-index: 2147483647;\n    background-color: rgba(0,0,0,0.5)\n  }\n  \n  body.tfc-show-modal #tfc-full-screen-container {\n    display: block;\n  }\n  \n  /* desktop */\n  body.tfc-large-screen #tfc-modal-wrapper {\n    right: 75px;\n    margin-top: 50px;\n    width: 375px;\n    height: 90vh;\n    min-height: 540px;\n    max-height: 765px;\n    border-radius: 15px;\n    position: absolute;\n  }\n  \n  body.tfc-large-screen #tfc-app-iframe {\n    border-radius: 15px;\n  }\n  \n  /* mobile */\n  body.tfc-show-modal.tfc-small-screen {\n    overflow: hidden;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 100%;\n  }\n  \n  body.tfc-small-screen #tfc-modal-wrapper {\n    position: fixed;\n    left: 0;\n    width: 100%;\n  }\n  \n  body.tfc-small-screen #tfc-modal-wrapper:not(.tfc-partial-height) {\n    top: 0;\n    height: 100%;\n  }\n  \n  body.tfc-small-screen #tfc-modal-wrapper.tfc-partial-height {\n    bottom: 0;\n    height: 90%;\n    height: var(--tfc-partial-modal-height, 90%);\n  }\n  \n  body.tfc-small-screen #tfc-modal-wrapper.tfc-partial-height #tfc-app-iframe {\n    border-top-left-radius: 15px;\n    border-top-right-radius: 15px;\n  }\n  \n  #tfc-app-iframe {\n    width: 100%;\n    height: 100%;\n    border: 0px solid;\n    background-color: #fff\n  }\n  ",r.head.appendChild(e)}();const e=r.createElement("div");e.setAttribute("aria-modal","true"),e.setAttribute("role","dialog"),e.id="tfc-full-screen-container";const t=r.createElement("div");t.id="tfc-modal-wrapper",e.appendChild(t),r.body.appendChild(e),e.addEventListener("click",(()=>{et("pageClick")}))}}();let a=Qe();a&&a.remove();const s=`${e}${t}&originUrl=${encodeURIComponent(r.location.origin)}`;a=r.createElement("iframe"),a.src=s,a.id="tfc-app-iframe";const c=r.getElementById("tfc-modal-wrapper");if(c){c.style.setProperty("--tfc-partial-modal-height",null!=o?o:"90%"),c.classList.toggle("tfc-partial-height",n),c.appendChild(a);const e=G();Xe(e),r.body.classList.add("tfc-show-modal"),r.body.classList.add(`tfc-${e}-screen`),i.setTimeout((()=>{var e;(null===(e=qe.state)||void 0===e?void 0:e.tfcModalVisible)||qe.pushState(Be,""),i.addEventListener("popstate",Ve)}))}else F.error("Unexpected error: #tfc-modal-wrapper element not found")}(s,(y=c,v={token:u,tfpAppConfigOverrides:Object.keys(null!=p?p:{}).length?encodeURIComponent(JSON.stringify({desktop:p,mobile:p})):void 0},Object.entries(null!=v?v:{}).reduce(((e,[t,n])=>!n||e.includes(`${t}=`)?e:`${e}&${t}=${n}`),y)),"Partial"===d,l)}function nt({widgetToken:e,iframeOrigin:t,iframePathAndHash:n}){return tt({iframeOrigin:t,iframePathAndHash:n,widgetToken:e},{mayReprocessWidgets:!1})}let it=[];const rt=new class{constructor(){this.callbacks=[]}listen(e){this.callbacks.push(e)}unlisten(e){const t=this.callbacks.indexOf(e);t>=0&&this.callbacks.splice(t,1)}unlistenAll(){this.callbacks.splice(0)}trigger(e){this.callbacks.slice().forEach((t=>t(e)))}},ot=(e,t,n)=>e.widgetName===t&&e.eventKey===n,at=(e,t)=>it.reduce(((n,i)=>ot(i,e,t)?n+1:n),0);function st(e,t,...n){return H().widgetHidden?0:(it.forEach((i=>{ot(i,e,t)&&i.listener(...n)})),at(e,t))}const ct=(e,t=63072e3)=>{g(e,t),Fe(e)};function dt(e,t=!0){var n,a,s;(null===(n=i.truefit)||void 0===n?void 0:n.initialized)?F.error("True Fit has already been initialized "):(function(e,t=!0){const{storeKey:n,environment:i="prod",autoCalculate:r=!0,deviceType:a="responsive",locale:s,userId:c,registered:d,widgetHidden:l,storeExperimentKey:f,cookieSameSiteNone:u}=e;if(null!==_)return void F.error("TF integration library can only be initialized once. Use truefit.update.");t&&Object.entries(e).forEach((([e,t])=>{e in P&&t&&(P[e]=!0)}));const p=()=>{let e;const t="https://cdn.truefitcorp.com";return"http"===t.substring(0,4)&&(e=t),o.TF_INTEGRATION_WIDGET_IFRAME_CDN_ORIGIN||e||`https://${n}-cdn.${"prod"!=i?`${i}.`:""}truefitcorp.com`};_={storeKey:n,environment:i,autoCalculate:r,deviceType:a,locale:s,userId:c,registered:d,widgetHidden:l,storeExperimentKey:f,cdnOrigin:p(),iframeWidgetUrl:o.TF_INTEGRATION_WIDGET_IFRAME_CDN_ORIGIN||`${p()}/tfp-widgets/${(()=>{const e="TFP_WIDGETS_PATH";return"TFP_WIDGETS_"!==e.substring(0,12)?e:n})()}/index.html`,cookieSameSiteNone:u}}(e,t),i.addEventListener("message",(e=>{F.debug("tf-integration message received",e);const{cdnOrigin:t}=H();if(e.origin===t)switch(e.data.type){case"sizeSamplingBannerDisplay":return void(({isDisplayed:e,iframeId:t})=>{Q().forEach((n=>{n.dataset.iframeid===t&&(e?n.setAttribute("data-tf-content-shown","true"):n.removeAttribute("data-tf-content-shown"))}))})(e.data);case"widgetHeight":return void(({height:e,iframeId:t})=>{const n=J.get(t);if(!n)return void F.warn("Tried to set widget height, but found no widget.");const i=n.iframe;if(!i.dataset.widgetRendered&&e>0){i.dataset.widgetRendered="true";const e=i.parentElement;for(;e&&e.firstChild&&e.firstChild!==i;)e.removeChild(e.firstChild)}i.style.height=e+"px",F.debug("Widget rendered at",performance.now())})(e.data);case"widgetWidth":return void(({width:e})=>{ne().forEach((t=>{t.style.maxWidth=e||"100%"}))})(e.data);case"tokenUpdate":return void ct(e.data.token,e.data.maxAge);case"appOpen":return void tt(e.data);case"deviceTypeUpdate":return e.data.deviceType&&(function(e){if(null===_)throw"TF integration library needs to be initialized. Use truefit.init.";_=Object.assign(Object.assign({},_),{deviceType:e})}(e.data.deviceType),r=e.data.deviceType,null==M||M.removeEventListener("change",D),z="desktop"===r?"large":"small"),void(e.data.fullScreenPopupZoomEnabled&&(n=e.data.fullScreenPopupZoomEnabled,De=n));case"widgetResponse":{const{widgetResponse:t,retailerWidgetResult:n,autoSizeSelect:i,bannerRegistration:r,idSyncProvidersWithFetchers:o,shopperProfileId:a}=e.data;F.debug("Sending widget response to all widgets.",t),Le({type:"widgetResponse",widgetResponse:t}),n&&st("tfc-fitrec-product","widgetResult",n),i&&i.forEach((e=>{st("tfc-fitrec-product","autoSizeSelect",e)}));const{experiments:s}=t;if(s&&st("tfc-fitrec-product","experiments",s),r&&function(e,t){const n=Z();n.length?(Ae.forEach((e=>e())),Ae=[],n.forEach((n=>{const i=n.dataset.ageGroup,r=n.dataset.gender,o=n.dataset.category,a=i?`&ageGroup=${i}`:"",s=r?`&gender=${r}`:"",c=o?`&productType=${o}`:"",d=t.iframePathAndHash+a+s+c,l=()=>e({widgetToken:t.widgetToken,iframeOrigin:t.iframeOrigin,iframePathAndHash:d});n.addEventListener("click",l),n.dataset.tfClickHandlerRegistered="true",Ae.push((()=>{n.removeEventListener("click",l)}))}))):F.error("Found no banner widgets to add a click handler to.")}(nt,r),a&&rt.trigger(a),o){const e={};let t=!1;for(const n in o){const i=U(o[n]);i?(t=!0,e[n]=i):F.debug(`True Fit - ID sync provider ID for ${n} not found.`)}t&&function(e){const t=Ee();t&&Ue(t,{type:"idSyncProviderIds",idSyncProviderIds:e})}(e)}return}}var n,r,o;if(o=e.origin,Me&&o===Me&&"string"==typeof e.data){const t=JSON.parse(e.data);switch(t.message){case"bannerredirect":return void(i.location.href=t.data.url);case"close":return void Ze();case"logout":case"refresh":return void We();case"usertoken":return void ct(t.data.value,t.data.maxAge);case"open":return void st("tfc-fitrec-register","open",t.data)}}})),function(){const{deviceType:e}=H();if("responsive"===e)try{M=i.matchMedia("(max-width: 769px)"),z=M.matches?"small":"large",M.addEventListener?M.addEventListener("change",D):M.addListener(D)}catch(e){F.error("Error when trying to use matchMedia - falling back to mobile",e),z="small"}else z="desktop"===e?"large":"small"}(),a=Le,K.push(a),H().autoCalculate&&(s=()=>We(),"loading"!==r.readyState?s():r.addEventListener("DOMContentLoaded",s)),i.truefit={initialized:!0})}function lt(e,t,n){return i=>{if(!(n&&void 0===i||i&&t.some((e=>e===i))))return`${e} should be one of [${t.join(",")}] but found ${i}`}}function ft(e,t,n=[],i=[]){return(r,o)=>{if(null==r)return void F.error(`${o} expected type ${e} but was passed ${r}`);const a=[],s=e=>{e&&a.push(e)};if(t.forEach((([e,t])=>{s(function(e,t,n){return"string"==typeof t?function(e,t,n){if(null==e||typeof e!==t)return`${n} is not defined or not a ${t}`}(e,t,n):t(e)}(r[e],t,e))})),n.forEach((([e,t])=>{s(function(e,t,n){return"string"==typeof t?function(e,t,n){if((null==e||typeof e!==t)&&void 0!==e)return`${n} is defined but not a ${t}`}(e,t,n):void 0!==e?t(e):void 0}(r[e],t,e))})),i.forEach((([e,t])=>{s(t(r[e]))})),0===a.length)return r;const c=a.join(", ");F.error(`${o} expected type ${e} but the passed value had the following errors [${c}]`)}}const ut=ft("LineItem",[["productId","string"],["quantity","number"],["price","number"],["currency","string"]],[["colorId","string"],["size","string"],["sku","string"],["salesGroup","string"]]),pt=(lt("CheckoutType",["LineItem","OrderNotify"],!1),lt("DeviceType",["desktop","mobile"],!0)),gt=lt("IntegrationPlatform",["web","app"],!0),ht=lt("Env",["dev","staging","prod"],!0),mt=lt("EventKey",["autoSizeSelect","experiments","widgetResult","open"],!1),yt=ft("SizeSamplingProductInfo",[["styleId","string"],["styleName","string"],["size","string"]]);function vt(e){if(null!=e&&("object"!=typeof e||e.constructor!==Object||!Object.entries(e).every((([,e])=>void 0!==kt(e,"products validator")))))return"products are not an optional object where the keys are style IDs and the values are objects with an optional colorId property"}const bt=ft("TFCheckout",[["orderId","string"],["products",function(e){if(!(Array.isArray(e)&&e.length>0&&e.every((e=>void 0!==ut(e,"validateCheckout")))))return"products are not a non-empty list of valid products"}]],[["userId","string"],["locale","string"],["widgetHidden","boolean"],["storeExperimentKey","string"],["deviceType",pt],["integrationPlatform",gt]]),wt=ft("TFTrackSession",[],[["locale","string"],["userId","string"],["widgetHidden","boolean"],["storeExperimentKey","string"],["referrerUri","string"]],[["deviceType",pt],["integrationPlatform",gt]]),Et=ft("TFUpdateWidget",[],[["products",vt],["orderId","string"],["locale","string"],["userId","string"],["widgetHidden","boolean"],["storeExperimentKey","string"]]),It=ft("TFUpdateWidget",[["storeKey","string"]],[["environment",ht],["autoCalculate","boolean"],["deviceType",pt]]),Ot=ft("TFCalculate",[],[["locale","string"],["userId","string"],["registered","boolean"],["widgetHidden","boolean"],["storeExperimentKey","string"],["products",vt],["orderId","string"]]),kt=ft("TFProduct",[],[["colorId","string"]]),Tt=["addtobag","close","complete","logout","pageload","render","update","chat","sizechart","error","success","incompleteprofile","incompletegarment","sizenotavailable","nouser","nostyle","nostylenouser","moreinfo","userdisabled","invaliddepartment"],$t={calculate(e){const t=Ot(e||{},"tfcapi-calculate");t?(function(e){const{locale:t,orderId:n,userId:i,registered:r,widgetHidden:o,storeExperimentKey:a,products:s}=e;L({locale:t,userId:i,registered:r,widgetHidden:o,storeExperimentKey:a},!1),n?Ne({orderId:n}):s?Ne({products:s}):We()}(t),e?fe(t):ue()):F.error(`tfcapi('calculate', payload) was called without a valid payload: ${e}.`)},init(e){const t=It(e,"tfcapi-init");(null==t?void 0:t.storeKey)?dt(t,!1):F.error("tfcapi('init', payload) was called without a storeKey on the payload")},update(e,t){const n=Et(t||{},`tfcapi-update-${e}`);n?(Ne(n),t?fe(n):ue()):F.error(`tfcapi('update', ${e}, payload) was called without a valid payload: ${t}.`)},track(e,t){if("checkout"===e){const e=bt(t,"tfcapi-track-checkout");return e?void He(Object.assign(Object.assign({},e),{checkoutType:"LineItem"})):void F.error(`tfcapi('track', 'checkout', payload) was called without a valid payload: ${t}.`)}if("session"===e){const e=wt(t||{},"tfcapi-track-session");return e?void function(e){const t=Ee();_e(e=Object.assign(Object.assign({},e),{deviceType:q(),integrationPlatform:"web",referrerUri:r.referrer,retailerReferer:i.location.href})),t?Ue(t,{type:"trackSession",sessionInfo:e}):Pe({sessionInfo:JSON.stringify(e)})}(e):void F.error(`tfcapi('track', 'session', payload) was called without a valid payload: ${t}.`)}F.warn(`tfcapi('track', '${e}', payload) called with an unknown tracking type '${e}'.`)},event(e,t,n){const i="tfcapi('event', context, key, handler)";if("string"!=typeof e)return void F.error(`${i} called with an invalid event context of type ${typeof e}.`,"Valid contexts: tfc-fitrec-product, tfc-fitrec-register");if("tfc-fitrec-product"!==e&&"tfc-fitrec-register"!==e)return void F.error(`${i} called with an unknown event context "${e}".`,"Valid contexts: tfc-fitrec-product, tfc-fitrec-register");const r=(e=>{const t=mt(e);if(Tt.includes(e)&&t)F.error_consoleOnly(t);else{if(!t)return e;F.error(t)}})(t);r&&(n?"function"==typeof n?function(e,t,n){it=[...it,{widgetName:e,eventKey:t,listener:n}],at(e,t)}(e,r,n):F.error(`${i} called with a non-function event handler.`):F.error(`${i} called without an event handler.`))},getToken(e){if("function"!=typeof e)return void F.error(`tfcapi('getToken', tokenHandler) called with invalid tokenHandler of type '${typeof e}'. Expected a function.`);const[t,n]=function(){const e=w("k");return[null==e?void 0:e.v,e?e.e-O():void 0]}();t&&n?e(t,n):F.error("Attempted to get the token, but no valid token exists.")},setToken(e,t){"string"==typeof e?void 0===t||"number"==typeof t?ct(e,t):F.error(`tfcapi('setToken', token, maxAge) called with invalid maxAge of type '${typeof t}'. Expected a number or undefined.`):F.error(`tfcapi('setToken', token, maxAge) called with invalid token of type '${typeof e}'. Expected a string.`)},listenForUserId(e){"function"==typeof e?rt.listen(e):F.error(`tfcapi('listenForUserId', userIdHandler) called with invalid userIdHandler of type '${typeof e}' - expected a function.`)},sizeSampling(e){const t=function(e){const t=Array.isArray(e)&&e.length>0;if(Array.isArray(e))return t&&e.every((e=>void 0!==yt(e,"validateSizeSamplingBanner")))?e:void 0;F.error("productInfo is not an array")}(e);t&&function(e){const t=Q(),n=JSON.stringify(e);t.forEach((e=>{if(e.hasAttribute("data-iframeid")){const t=e.getAttribute("data-iframeid");!function(e,t){t&&Ue(t,{type:"productInfo",productInfo:e})}(n,t)}else ce(Object.assign(Object.assign({},re("tfc-fitrec-size-sampling")),{productInfo:n}),"size-sampling-banner",e)}))}(t)},getProductInfo(e,t){if(!e)return void F.error("tfcapi('getProductInfo', argsObj, handler) called without an arguments object.");if("object"!=typeof e)return void F.error(`tfcapi('getProductInfo', argsObj, handler) called with invalid argsObj of type '${typeof e}'. Expected an object.`);const{styleId:n,locale:i}=e;"string"==typeof n?void 0===i||"string"==typeof i?"function"==typeof t?function({styleId:e,locale:t}){return k(this,void 0,void 0,(function*(){try{const n=$(),i=T(),r=yield x(n,i),o={};o["X-TF-UserToken"]=r;const a=encodeURIComponent(e),s=t?`locale=${encodeURIComponent(t)}`:"",c=yield fetch(`${n}/profile/public/v3/${i}/products/${a}?${s}`,{headers:o});if(c.ok)return yield c.json()}catch(e){F.error("Error trying to fetch product info",e)}}))}({styleId:n,locale:i}).then(t):F.error(`tfcapi('getProductInfo', argsObj, handler) called with invalid handler of type '${typeof t}'. Expected a function.`):F.error(`tfcapi('getProductInfo', argsObj, handler) called with invalid argsObj. Found argsObj.locale of type '${typeof i}'. Expected a string or undefined.`):F.error(`tfcapi('getProductInfo', argsObj, handler) called with invalid argsObj. Found argsObj.styleId of type '${typeof n}'. Expected a string.`)}};var xt;if(function(){var e;if(i.tfcapi.tfIntegrationLoaded)return;const t=i.tfcapi;i.tfcapi=function(e,...t){if(e in $t)return $t[e](...t);F.error(`tfcapi was called with invalid function name ${e}`)},null===(e=t.q)||void 0===e||e.sort(((e,t)=>"init"===e[0]?-1:"init"===t[0]?1:0)).forEach((e=>{i.tfcapi(e[0],e[1],e[2],e[3])})),i.tfcapi.loaded=!0,i.tfcapi.tfIntegrationLoaded=!0}(),!(null===(xt=i.truefit)||void 0===xt?void 0:xt.initialized)){const{storeKey:e,environment:t,autoCalculate:n,deviceType:i}=function(){const e={},t=(t,n)=>{const i=e[t];void 0!==i&&i!==n?F.error(`Mismatched values were passed to the integration block for ${t} using ${i}`):e[t]=n};return[...r.getElementsByTagName("script")].forEach((e=>{const n=e.src.match(/\/fitrec\/([a-z]{3,10})\/js\/(tracker|fitrec)\.js/);if(n){(e.src.split("?",2)[1]||"").split("&").forEach((e=>{const n=e.split("=",2);2===n.length&&t(n[0],n[1])}));const i=n[1];i&&t("storeKey",i);const r=e.src.match(/[a-z]{3,10}-cdn(?:\.(dev|staging))?\.truefitcorp\.com/),o=null==r?void 0:r[1];o&&t("environment",o)}})),e}();e&&dt({storeKey:e,environment:t,autoCalculate:void 0===n||"true"===n,deviceType:i})}})();